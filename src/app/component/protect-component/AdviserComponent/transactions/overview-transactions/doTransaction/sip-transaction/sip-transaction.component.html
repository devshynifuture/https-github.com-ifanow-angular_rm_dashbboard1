<div class="popup-header-fix w-65">
    <div class="row bb-1">
        <div class="col-md-8 p-0">
            <h3 class="mb-0 wrapper-20">{{transactionType}} TRANSACTION</h3>
        </div>
        <div class="col-md-4 text-right">
            <div class="wrapper-12">
                <i (click)="close()" class="material-icons c-p pt-8 v-middle"> clear</i>
            </div>
        </div>
    </div>
</div>
<div [formGroup]="sipTransaction">

    <div class="pt-90 pr-20 pl-20 pb-44">
        <div class="row">
            <div class="col-md-12 p-0">
                <h5 class="m-0 text-black"> <img src="/assets/images/svg/back-arrow.svg"
                        class="v-initial pr-12">Investor name: {{selectedFamilyMember}}
                </h5>
            </div>
        </div>
        <div class="col-md-12 mt-20 all-transactions" *ngIf="multiTransact == true">
            <table mat-table [dataSource]="childTransactions" id="table-low">
                <ng-container matColumnDef="no">
                    <th mat-header-cell *matHeaderCellDef class="br"> No</th>
                    <td *matCellDef="let element let i = index;" class="br w-15 " mat-cell>
                        <div class="bar"> {{i + 1 }} </div>
                    </td>
                </ng-container>
                <ng-container matColumnDef="folio">
                    <th mat-header-cell *matHeaderCellDef class="br w-20"> Folio </th>
                    <td mat-cell *matCellDef="let element" class="br">
                        <div class="bar"> {{element.folioNo}} </div>
                    </td>
                </ng-container>
                <ng-container matColumnDef="ownerName">
                    <th mat-header-cell *matHeaderCellDef class="br w-25"> Scheme name</th>
                    <td mat-cell *matCellDef="let element" class="br">
                        <div class="bar">
                            {{element.schemeName}}
                        </div>
                    </td>
                </ng-container>
                <ng-container matColumnDef="amount">
                    <th mat-header-cell *matHeaderCellDef class="br w-20"> Amount </th>
                    <td mat-cell *matCellDef="let element" class="br">
                        <div class="bar"> {{element.orderVal}} </div>
                    </td>
                </ng-container>
                <tr mat-header-row *matHeaderRowDef="displayedColumns; sticky: true"></tr>
                <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
            </table>
        </div>
        <div class="row pt-20 pb-44">
            <div class="col-md-8 pl-0 pr-20">
                <div class="row">
                    <div class="col-md-12 p-0 text-left">
                        <h5 class="m-0 pb-8 text-black">Select from the following options</h5>
                        <mat-radio-group class="bigRadio" aria-label="Select an option"
                            formControlName="schemeSelection" (ngModelChange)="selectSchemeOption($event)">
                            <mat-radio-button value="1"
                                [ngClass]="{'b-a-custom': sipTransaction.get('schemeSelection').value==1,'text-primary':sipTransaction.get('schemeSelection').value==1,'radio-border':sipTransaction.get('schemeSelection').value==2}"
                                class="b-a-custom radioBtn text-primary custom-radio bor_top_tb_left">
                                Invest in existing scheme
                            </mat-radio-button>
                            <mat-radio-button value="2"
                                [ngClass]="{'b-a-custom': sipTransaction.get('schemeSelection').value==2,'text-primary':sipTransaction.get('schemeSelection').value==2,'radio-border':sipTransaction.get('schemeSelection').value==1}"
                                class="bor_top_tb_right radio-border radioBtn ">
                                Select a new scheme</mat-radio-button>
                        </mat-radio-group>
                    </div>
                </div>
                <!-- value == 1 -->
                <div class="row">
                    <div class="col-md-12 p-0 text-left">
                        <h5 class="m-0 pt-28 text-black pb-8">Select a scheme to invest in</h5>
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-11 p-0">
                        <div class="form-group">
                            <mat-form-field>
                                <input type="text" aria-label="Number" class="form-control" matInput
                                    [matAutocomplete]="auto" (keyup)="getSchemeList($event.target.value)"
                                    placeholder="Start typing to see investor names">
                                <mat-autocomplete #auto="matAutocomplete">
                                    <mat-option (onSelectionChange)="selectedScheme(scheme)"
                                        *ngFor="let scheme of schemeList" [value]="scheme.schemeName">
                                        {{scheme.schemeName}}
                                    </mat-option>
                                </mat-autocomplete>
                                <mat-hint align="start" class="f-12 text-custom">
                                    Last closing NAV: {{navOfSelectedScheme}}
                                </mat-hint>
                                <mat-error class="f-12 pt-4">
                                    This field is required
                                </mat-error>
                            </mat-form-field>
                        </div>
                    </div>
                    <!-- removed for prod build" -->
                    <div class="col-md-1" *ngIf="showSpinner == true">
                        <mat-spinner class="mt-8"></mat-spinner>
                    </div>
                </div>

                <div class="row pt-28 " *ngIf="reInvestmentOpt.length > 1">
                    <div class="col-md-12 p-0 text-left">
                        <h5 class="m-0 text-black pb-8">Select re-investment</h5>
                    </div>
                    <div class="col-md-5 p-0">
                        <div class="form-group mb-0">
                            <mat-form-field>
                                <mat-select class="form-control" formControlName="investmentAccountSelection">
                                    <mat-option value="option" *ngFor="let flag of reInvestmentOpt"
                                        (click)="reinvest(flag)">
                                        {{(flag.dividendReinvestmentFlag == 0)?'Dividend payout':'Dividend reinvestment'}}
                                    </mat-option>
                                </mat-select>
                                <mat-error class="f-12 pt-4">
                                    This field is required
                                </mat-error>
                            </mat-form-field>
                        </div>
                    </div>
                </div>

                <div class="row pt-28 ">
                    <div class="col-md-12 p-0 text-left">
                        <h5 class="m-0 text-black pb-8">Select folio</h5>
                    </div>
                    <div class="col-md-12 p-0">
                        <mat-radio-group aria-label="Select an option" formControlName="folioSelection"
                            (ngModelChange)="selectExistingOrNew($event)">
                            <mat-radio-button value="1"
                                [ngClass]="{'b-a-custom': sipTransaction.get('folioSelection').value==1,'text-primary':sipTransaction.get('folioSelection').value==1,'radio-border':sipTransaction.get('folioSelection').value==2}"
                                class="b-a-custom bor_top_tb_left radioBtn text-primary custom-radio">
                                Existing
                            </mat-radio-button>
                            <mat-radio-button value="2"
                                [ngClass]="{'b-a-custom': sipTransaction.get('folioSelection').value==2,'text-primary':sipTransaction.get('folioSelection').value==2,'radio-border':sipTransaction.get('folioSelection').value==1}"
                                class="radio-border bor_top_tb_right radioBtn ">
                                New </mat-radio-button>
                        </mat-radio-group>
                    </div>
                </div>

                <div class="row pt-40" *ngIf="ExistingOrNew == 1">
                    <div class="col-md-6 p-0 text-left">
                        <h5 class="m-0  text-black pb-8">Select scheme folio</h5>
                    </div>
                    <div class="col-md-7 p-0">
                        <div class="form-group mb-0">
                            <mat-form-field>
                                <mat-select class="form-control" formControlName="investmentAccountSelection">
                                    <mat-option value="option" (click)="selectedFolio(folio)"
                                        *ngFor="let folio of folioList">{{folio.folioNumber}}</mat-option>
                                </mat-select>
                                <mat-error class="f-12 pt-4">
                                    This field is required
                                </mat-error>
                            </mat-form-field>
                        </div>
                    </div>
                    <div class="col-md-1" *ngIf="showSpinner == true">
                        <mat-spinner class="mt-8"></mat-spinner>
                    </div>
                </div>

                <div class="row pt-40 ">
                    <div class="col-md-12 p-0 text-left">
                        <h5 class="m-0 text-black pb-8">Select SIP frequency</h5>
                    </div>
                    <div class="col-md-5 p-0">
                        <div class="form-group mb-0">
                            <mat-form-field>
                                <mat-select class="form-control" formControlName="frequency">
                                    <mat-option value="option" (click)="selectedFrequency(frequency)"
                                        *ngFor="let frequency of sipFrequency">{{frequency.frequency}}</mat-option>
                                </mat-select>
                                <mat-error class="f-12 pt-4">
                                    This field is required
                                </mat-error>
                            </mat-form-field>
                        </div>
                    </div>
                </div>
                <div class="row pt-28">
                    <div class="col-md-12 p-0 text-left">
                        <h5 class="m-0  text-black pb-8">Enter amount</h5>
                    </div>
                    <div class="col-md-5 p-0">
                        <div class="form-group iconRupess mb-0">
                            <mat-form-field>
                                <input #employeeContry matInput maxlength="10" type="text"
                                    class="form-control br-0 rupess" formControlName="employeeContry"
                                    (change)="enteredAmount($event.target.value)">
                                <mat-hint align="start" class="f-12 text-custom">
                                    Min amount:
                                    â‚¹{{(schemeDetails == undefined)?'-':schemeDetails.minimumPurchaseAmount }}
                                </mat-hint>
                                <mat-error *ngIf="(sipTransaction.get('employeeContry').errors?.min)" class="f-12">
                                    Should be greater than or equal to {{schemeDetails.minimumPurchaseAmount}}
                                </mat-error>
                                <mat-error *ngIf="(sipTransaction.get('employeeContry').errors?.required)" class="f-12">
                                    This field is requied
                                 </mat-error>
                            </mat-form-field>
                        </div>
                    </div>
                </div>
                <div class="row" *ngIf="platformType == 1">
                    <div class="col-md-5 p-0 text-left">
                        <h5 class="m-0 pt-40 text-black pb-12">Select mode of payment</h5>
                    </div>
                    <div class="col-md-12 p-0">
                        <mat-radio-group aria-label="Select an option" formControlName="modeOfPaymentSelection"
                            (ngModelChange)="selectPaymentMode($event)">
                            <mat-radio-button value="1" checked="true"
                                [ngClass]="{'b-a-custom': sipTransaction.get('modeOfPaymentSelection').value==1,'text-primary':sipTransaction.get('modeOfPaymentSelection').value==1,'b-a':sipTransaction.get('modeOfPaymentSelection').value==2}"
                                class="b-a-custom radioBtn text-primary custom-radio bor_top_tb_left">
                                Net banking
                            </mat-radio-button>
                            <mat-radio-button value="2"
                                [ngClass]="{'b-a-custom': sipTransaction.get('modeOfPaymentSelection').value==2,'text-primary':sipTransaction.get('modeOfPaymentSelection').value==2,'b-a':sipTransaction.get('modeOfPaymentSelection').value==1}"
                                class="b-a radioBtn bor_top_tb_right">
                                Debit mandate </mat-radio-button>
                        </mat-radio-group>
                    </div>
                    <div class="col-md-1" *ngIf="showSpinnerMandate == true">
                        <mat-spinner class="mt-8"></mat-spinner>
                    </div>
                </div>
                <div class="row pt-40">
                    <div class="col-md-12 p-0 text-left">
                        <h5 class="m-0  text-black pb-8">Select 1st date SIP</h5>
                    </div>

                    <div class="col-md-5 p-0">
                        <mat-form-field>
                            <mat-select class="form-control" formControlName="date">
                                <mat-option value="{{date.dateToDisplay}}" *ngFor="let date of dateDisplay">
                                    {{date.dateToDisplay}}</mat-option>
                            </mat-select>
                            <mat-error class="f-12 pt-4">
                                This field is required
                            </mat-error>
                        </mat-form-field>
                    </div>
                </div>
                <div class="row pt-28">
                    <div class="col-md-12 p-0 text-left">
                        <h5 class="m-0  pb-8 text-black">Select tenure</h5>
                    </div>

                    <div class="col-md-5 p-0">
                        <mat-form-field>
                            <mat-select class="form-control" formControlName="tenure">
                                <mat-option value="1">No. of installment</mat-option>
                                <mat-option value="2">No. year</mat-option>
                                <mat-option *ngIf="getDataSummary && getDataSummary.defaultClient.aggregatorType == 1"
                                    value="3">Continue
                                    until cancelled</mat-option>
                            </mat-select>
                            <mat-error class="f-12 pt-4">
                                This field is required
                            </mat-error>
                        </mat-form-field>
                    </div>
                </div>
                <div class="row pt-28" *ngIf="(sipTransaction.get('tenure').value) != 3">
                    <div class="col-md-12 p-0 text-left">
                        <h5 class="m-0  pb-8 text-black">Enter installment</h5>
                    </div>

                    <div class="col-md-5 p-0">
                        <mat-form-field>
                            <input #employeeContry matInput maxlength="10" type="text" class="form-control br-0 rupess"
                                formControlName="installment">
                            <mat-error class="f-12 pt-4">
                                This field is required
                            </mat-error>
                        </mat-form-field>
                    </div>
                </div>
            </div>
            <div class="col-md-4 bg-grey lter p-0">
                <app-transaction-summary [data]="transactionSummary" (defaultDetails)='getDefaultDetails($event)'
                    (bankDetailsSend)='getbankDetails($event)' (folioChange)='onFolioChange($event)'>
                </app-transaction-summary>
            </div>
        </div>
    </div>

</div>
<div class="bottom-fixed wrapper-12 pt-16 w-65">
    <div class="row">
        <div class="col-md-4 pt-8">
            <h5 class="mb-0  text-white c-p" (click)="close()">Cancel</h5>
        </div>
        <!-- <div class="col-md-8 right pt-8" *ngIf="formStep == 'step-1' || formStep == 'step-2'">

            <h5 class="mb-0 text-white c-p" (click)="saveAndNext()"> NEXT </h5>
        </div> -->
        <div class="col-md-8 text-right  ">
            <!-- commented for prod build -->
            <button mat-button class="text-success" (click)="AddMultiTransaction()">
                SAVE & ADD ANOTHER
            </button>
            <button mat-button class="text-success" (click)="sip()">
                SAVE & PROCEED
            </button>
        </div>
    </div>
</div>