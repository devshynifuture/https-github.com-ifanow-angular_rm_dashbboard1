<div class="popup-header-fix w-65">
  <div class="row bb-1">
    <div class="col-md-8 p-0">
      <h3 class="mb-0 wrapper-20">NEW TRANSACTION</h3>
    </div>
    <div class="col-md-4 text-right">
      <div class="wrapper-12">
        <i (click)="close()" class="material-icons c-p pt-8 v-middle"> clear</i>
      </div>
    </div>
  </div>
</div>

<div [formGroup]="transactionAddForm">
  <!-- first page -->
  <div *ngIf="formStep == 'step-1' || formStep == 'step-2' && transactionType==undefined"
       class="pt-90 pr-40 pl-40 pb-40">
    <div class="row">
      <div class="col-md-8 p-0">
        <h5 class="m-0 text-black pb-12">Select an investor from the search box below...</h5>
        <mat-form-field appearance="standard" floatLabel="never">
          <!--                  debounceChangedValue-->
          <input #searchClient (keyup)="ownerList($event.target.value)" (valueChange1)='lisNominee($event)'
                 [data]='searchClient.value' [matAutocomplete]="auto1" appClientSearch
                 aria-label="client" class="form-control pl-8" formControlName="ownerName"
                 matInput placeholder="Start typing to see investor names">
          <mat-autocomplete #auto1="matAutocomplete">
            <mat-option (onSelectionChange)="ownerDetails(f)" *ngFor="let f of nomineesListFM"
                        [value]="f.name">
              <span>{{f.name}}</span>
            </mat-option>
          </mat-autocomplete>
          <mat-error *ngIf="transactionAddForm.get('ownerName').errors?.required" class="f-12 pt-4">
            This field is required
          </mat-error>
          <mat-error *ngIf="transactionAddForm.get('ownerName').errors?.setValue" class="f-12">
            This family member does not exist
          </mat-error>
        </mat-form-field>
      </div>
      <div *ngIf="showSpinnerOwner == true" class="col-md-1 align-items-end d-flex">
        <mat-spinner class=" "></mat-spinner>
      </div>
    </div>
  </div>

  <div *ngIf="clientCodeData == undefined" class="d-flex flex-column align-items-center">
    <h4 class="text-center pt-12">No IIN/UCC found</h4>
    <button (click)="openNewCustomerIIN()" class="btn-green text-white" mat-button>IIN/UCC CREATION</button>
  </div>
  <!-- second click -->
  <div *ngIf="formStep == 'step-2' &&  transactionType==undefined">
    <div class="row pt-10 pl-40 pr-40">
      <div class="col-md-12 p-0">
        <h5 class="m-0 text-black">Great! Next, select a transaction type from the below given options...</h5>
      </div>
    </div>
    <div class="row pt-12 pl-32 pr-32">
      <div (click)="selectTransactionType('PURCHASE')" class="col-md-4 pl-8 pr-8 c-p">
        <mat-checkbox [ngClass]="{'v-h': selectedDiv != 'PURCHASE' }"
                      [ngStyle]="{'pointer-events': (selectedDiv == 'PURCHASE') ? 'all': 'none'}" checked="false"
                      class="checked"></mat-checkbox>
        <div [ngClass]="{'b-a-custom': selectedDiv == 'PURCHASE'}" class="row pt-20 pb-20 ba-Tr bg-grey lter">
          <div class="col-md-4 text-right">
            <img class="pt-4"
                 src="/assets/images/svg/shopping{{ (selectedDiv == 'PURCHASE') ? '-blue': '-icons' }}.svg">
          </div>
          <div class="col-md-8 pl-0">
            <h3 [ngClass]="{ 'text-primary': selectedDiv == 'PURCHASE' }" class="m-0"> Purchase</h3>
            <p [ngClass]="{ 'text-primary': selectedDiv == 'PURCHASE' }"
               class="m-0 roboto text-custom pt-4 f-13">Invest a lumpsum amount in a jiffy
            </p>
          </div>
        </div>
      </div>
      <div (click)="selectTransactionType('SWITCH')" class="col-md-4 pl-8 pr-8  c-p">
        <mat-checkbox [ngClass]="{'v-h':selectedDiv != 'SWITCH' }"
                      [ngStyle]=" {'pointer-events': (selectedDiv == 'SWITCH') ? 'all': 'none'}" checked="false"
                      class="checked">
        </mat-checkbox>
        <div [ngClass]="{'b-a-custom': selectedDiv == 'SWITCH'}" class="row pt-20 pb-20 ba-Tr bg-grey lter">
          <div class="col-md-4 text-right">
            <img class="pt-4"
                 src="/assets/images/svg/switch{{ (selectedDiv == 'SWITCH') ? '-blue': '-icons' }}.svg">
          </div>
          <div class="col-md-8 pl-0">
            <h3 [ngClass]="{ 'text-primary': selectedDiv == 'SWITCH' }" class="m-0"> Switch</h3>
            <p [ngClass]="{ 'text-primary': selectedDiv == 'SWITCH' }"
               class="m-0 roboto text-custom pt-4 f-13">Switch lumpsum from one scheme to
              another
            </p>
          </div>
        </div>
      </div>
      <div (click)="selectTransactionType('REDEMPTION')" class="col-md-4 pl-8 pr-8  c-p">
        <mat-checkbox [ngClass]="{'v-h':selectedDiv != 'REDEMPTION' }"
                      [ngStyle]="{'pointer-events': (selectedDiv == 'REDEMPTION') ? 'all': 'none'}" checked="false"
                      class="checked"></mat-checkbox>
        <div [ngClass]="{'b-a-custom': selectedDiv == 'REDEMPTION'}" class="row pt-20 pb-20 ba-Tr bg-grey lter">
          <div class="col-md-4 text-right">
            <img class="pt-4"
                 src="/assets/images/svg/reedem{{ (selectedDiv == 'REDEMPTION') ? '-blue': '-icons' }}.svg">
          </div>
          <div class="col-md-8 pl-0">
            <h3 [ngClass]="{ 'text-primary': selectedDiv == 'REDEMPTION' }" class="m-0"> Redeem</h3>
            <p [ngClass]="{ 'text-primary': selectedDiv == 'REDEMPTION' }"
               class="m-0 roboto text-custom pt-4 f-13">Redeem from your existing
              schemes
            </p>
          </div>
        </div>
      </div>

    </div>
    <div class="row pt-12 pl-32 pr-32">
      <div (click)="selectTransactionType('SIP')" class="col-md-4 pl-8 pr-8  c-p">
        <mat-checkbox [ngClass]="{'v-h':selectedDiv != 'SIP' }"
                      [ngStyle]="{'pointer-events': (selectedDiv == 'SIP') ? 'all': 'none'}" checked="false"
                      class="checked"></mat-checkbox>
        <div [ngClass]="{'b-a-custom': selectedDiv == 'SIP'}" class="row pt-20 pb-20 ba-Tr bg-grey lter">
          <div class="col-md-4 text-right">
            <img class="pt-4"
                 src="/assets/images/svg/sip{{ (selectedDiv == 'SIP') ? '-blue': '-icons' }}.svg">
          </div>
          <div class="col-md-8 pl-0">
            <h3 [ngClass]="{ 'text-primary': selectedDiv == 'SIP' }" class="m-0"> SIP</h3>
            <p [ngClass]="{ 'text-primary': selectedDiv == 'SIP' }"
               class="m-0 roboto text-custom pt-4 f-13">Start a systematic investment plan</p>
          </div>
        </div>
      </div>
      <div (click)="selectTransactionType('STP')" class="col-md-4 pl-8 pr-8  c-p">
        <mat-checkbox [ngClass]="{'v-h':selectedDiv != 'STP' }"
                      [ngStyle]="{'pointer-events':(selectedDiv == 'STP') ? 'all': 'none'}" checked="false"
                      class="checked"></mat-checkbox>
        <div [ngClass]="{'b-a-custom': selectedDiv == 'STP'}" class="row pt-20 pb-20 ba-Tr bg-grey lter">
          <div class="col-md-4 text-right">
            <img class="pt-4"
                 src="/assets/images/svg/switch{{ (selectedDiv == 'STP') ? '-blue': '-icons' }}.svg">
          </div>
          <div class="col-md-8 pl-0">
            <h3 [ngClass]="{ 'text-primary': selectedDiv == 'STP' }" class="m-0"> STP</h3>
            <p [ngClass]="{ 'text-primary': selectedDiv == 'STP' }"
               class="m-0 roboto text-custom pt-4 f-13">Systematic transfer from one scheme to
              another
            </p>
          </div>
        </div>
      </div>
      <div (click)="selectTransactionType('SWP')" class="col-md-4 pl-8 pr-8  c-p">
        <mat-checkbox [ngClass]="{'v-h':selectedDiv != 'SWP' }"
                      [ngStyle]="{'pointer-events':(selectedDiv == 'SWP') ? 'all': 'none'}" checked="false"
                      class="checked"></mat-checkbox>
        <div [ngClass]="{'b-a-custom': selectedDiv == 'SWP'}" class="row pt-20 pb-20 ba-Tr bg-grey lter">
          <div class="col-md-4 text-right">
            <img class="pt-4"
                 src="/assets/images/svg/reedem{{ (selectedDiv == 'SWP') ? '-blue': '-icons' }}.svg">
          </div>
          <div class="col-md-8 pl-0">
            <h3 [ngClass]="{ 'text-primary': selectedDiv == 'SWP' }" class="m-0"> SWP</h3>
            <p [ngClass]="{ 'text-primary': selectedDiv == 'SWP' }"
               class="m-0 roboto text-custom pt-4 f-13">Systematic withdrawal from a scheme
            </p>
          </div>
        </div>
      </div>

    </div>
  </div>


  <!-- third click -->
  <!-- last step ui -->
  <!-- <div class="pt-90 pr-20 pl-20 pb-44" *ngIf="formStep== 'step-3'">
      <div class="row">
          <div class="col-md-12 p-0">
              <h5 class="m-0 text-black"> <img (click)="baackToSelectTransaction()" src="/assets/images/svg/back-arrow.svg" class="v-initial pr-12">Investor name: Rahul Jain
              </h5>
          </div>
      </div>
      <div class="row pt-20 pb-44">
          <div class="col-md-8 pl-0 pr-20" *ngIf="isSaveAndAddClicked">
              <h5 class="m-0 pb-10 text-black">Select from the following options</h5>
              <mat-radio-group aria-label="Select an option" formControlName="schemeSelection">
                  <mat-radio-button [value]="1" [ngClass]="transactionAddForm.get('schemeSelection').value == 1 ? 'text-primary bu-primary': 'b-a text-primitive'">
                      Invest in existing scheme
                  </mat-radio-button>
                  <mat-radio-button [value]="2" [ngClass]="transactionAddForm.get('schemeSelection').value == 2 ? 'text-primary bu-primary': 'b-a text-primitive'">
                      Select a new scheme
                  </mat-radio-button>
              </mat-radio-group>
              <h5 class="m-0 pt-28 text-black pb-12">Select a scheme to invest in</h5>
              <div class="form-control mb-0 add-transactions">
                  <input type="text" aria-label="Number" class="form-group h-0" matInput formControlName="investor" [matAutocomplete]="auto" value="Start typing to see investor names">
                  <mat-autocomplete #auto="matAutocomplete">
                      <mat-option [value]="options" *ngFor="let options of investorsArray">
                          rahul jain
                      </mat-option>
                  </mat-autocomplete>
                  <p class="m-0 f-12 text-custom pt-8">Last closing NAV: 390.27</p>
              </div>
              <h5 class="m-0 pt-28 text-black pb-12">Select folio</h5>
              <mat-radio-group aria-label="Select an option" formControlName="folioSelection">
                  <mat-radio-button value="1" class="b-a-custom text-primary"> Existing
                  </mat-radio-button>
                  <mat-radio-button value="2" class="b-a text-primitive">New </mat-radio-button>
              </mat-radio-group>
              <h5 class="m-0 pt-28 text-black pb-12">Enter amount</h5>
              <div class="form-group mb-0">
                  <mat-form-field>
                      <input #employeeContry matInput maxlength="10" type="text" class="form-control br-0 rupess" formControlName="employeeContry">
                  </mat-form-field>
                  <p class="m-0 f-12 text-custom">Min amount: ₹500</p>
              </div>
              <h5 class="m-0 pt-28 text-black pb-12">Select investment account</h5>
              <div class="form-group mb-0">
                  <mat-form-field>
                      <mat-select class="form-control" formControlName="investmentAccountSelection">
                          <mat-option value="option">Option</mat-option>
                      </mat-select>
                  </mat-form-field>
              </div>
              <h5 class="m-0 pt-40 text-black pb-12">Select mode of payment</h5>
              <mat-radio-group aria-label="Select an option" formControlName="modeOfPaymentSelection">
                  <mat-radio-button value="1" class="b-a-custom text-primary"> Net banking
                  </mat-radio-button>
                  <mat-radio-button value="2" class="b-a text-primitive">Debit mandate </mat-radio-button>
              </mat-radio-group>
              <h5 class="m-0 pt-40 pb-12 text-black">Select bank account</h5>
              <mat-form-field>
                  <mat-select class="form-control" formControlName="bankAccountSelection">
                      <mat-option value="option">Option</mat-option>
                  </mat-select>
              </mat-form-field>
          </div>
          <div class="col-md-8 pl-0 pr-20" *ngIf="isSaveAndAddClicked">
              <div class="row">
                  <div class="col-md-12 p-0 text-center">
                      <img src="/assets/images/svg/last-step.svg" class="pt-28">
                      <h3 class="m-0 text-primary pt-24">So far so good. One last step!</h3>
                      <h5 class="m-0 pt-12 pb-12 b-h-dashed">Your client needs to <b>authorize</b> the transaction to
                          <b>complete</b> it.</h5>
                  </div>
              </div>
              <div class="row">
                  <div class="col-md-12">
                      <div class="p-8">
                          <p class="m-0 roboto pt-28"> An email has been sent to <b>registered email id.</b> Your client should review the <b>transaction
                                  details</b> and click on the <b>payment link</b> provided there.</p>


                          <p class="m-0 roboto pt-28"> Next, your client will be redirected to the <b>net banking
                                  page.</b> The client needs to login and make the payment.</p>


                          <p class="m-0 roboto pt-28"> Once the payment is done, NSE NMF will send a <b>confirmation
                                  email</b> to the registered email id.</p>


                          <p class="m-0 roboto pt-28"> Additionally, the Purchase transaction has been added to the
                              <u> Transaction List.</u></p>


                          <p class="m-0 roboto pt-28"> Track transaction status - <u>Track.</u></p>
                      </div>
                  </div>
              </div>
          </div>
          <div class="col-md-4 bg-grey lter p-0">
              <mat-tab-group animationDuration="0ms" mat-align-tabs="center" id="ui-addtransaction-tabs">
                  <mat-tab label="Transaction summary">
                      <div class="p-20 transaction-summary">
                          <div class="row pt-16 pb-16">
                              <div class="col-md-9">
                                  <p class="m-0 roboto text-custom">Transaction platform</p>
                                  <h5 class="m-0">NSE NMF II</h5>
                              </div>
                              <div class="col-md-2">
                                  <button mat-stroked-button class="primary-sm">Edit</button>
                              </div>
                          </div>
                          <div class="row  pt-16 pb-16">
                              <div class="col-md-9">
                                  <p class="m-0 roboto text-custom">Investor details</p>
                                  <h5 class="m-0">Rahul Jain</h5>
                                  <h5 class="m-0"> IIN 5011102595 (Joint)</h5>
                              </div>
                              <div class="col-md-2">
                                  <button mat-stroked-button class="primary-sm">Edit</button>
                              </div>
                          </div>
                          <div class="row  pt-16 pb-16">
                              <div class="col-md-9">
                                  <p class="m-0 roboto text-custom">ARN/RIA and EUIN</p>
                                  <h5 class="m-0">ARN-83866
                                  </h5>
                                  <h5 class="m-0"> E023539 - Ankit Mehta</h5>
                              </div>
                              <div class="col-md-2">
                                  <button mat-stroked-button class="primary-sm">Edit</button>
                              </div>
                          </div>
                          <div class="row  pt-16 pb-16">
                              <div class="col-md-12 p-0">
                                  <p class="m-0 roboto text-custom">Scheme, folio and amount</p>
                                  <h5 class="m-0"><span class="f-500">Scheme:</span> Axis Liquid Fund -Regular Plan - Weekly Dividend Option
                                  </h5>
                                  <h5 class="m-0"> <span class="f-500">Folio:</span> 91032325824</h5>
                                  <h5 class="m-0"> <span class="f-500">Amount:</span> ₹5,00,000/Lumpsum</h5>
                              </div>
                          </div>
                          <div class="row  pt-16 pb-16">
                              <div class="col-md-9">
                                  <p class="m-0 roboto text-custom">TRANSACTION INITIATION</p>
                                  <h5 class="m-0">Immediate</h5>
                              </div>
                              <div class="col-md-2">
                                  <button mat-stroked-button class="primary-sm">Edit</button>
                              </div>
                          </div>
                          <div class="row  pt-16 pb-16">
                              <div class="col-md-9">
                                  <p class="m-0 roboto text-custom">Mode of payment</p>
                                  <h5 class="m-0">Net banking</h5>
                              </div>
                          </div>
                          <div class="row  pt-16 pb-16">
                              <div class="col-md-9">
                                  <p class="m-0 roboto text-custom">Bank A/c details</p>
                                  <h5 class="m-0">ICICI Bank</h5>
                                  <h5 class="m-0"> Saving A/c 1032*****710</h5>
                              </div>
                              <div class="col-md-2">
                                  <button mat-stroked-button class="primary-sm">Edit</button>
                              </div>
                          </div>
                      </div>
                  </mat-tab>
                  <mat-tab label="Rationale">
                      <div class="p-20 rationaletabs">
                          <p class="m-0 roboto text-custom">The scheme seeks to generate long-term capital appreciation from a diversified portfolio of predominantly equity and equity related instruments.
                          </p>
                          <p class="m-0 roboto text-custom pt-20"> Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Sit amet nulla facilisi morbi tempus iaculis. Dui ut ornare lectus sit amet est placerat in egestas.
                              Sed turpis tincidunt id aliquet risus feugiat in. Magna sit amet purus gravida quis blandit turpis cursus.
                          </p>
                          <div class="row pt-12">
                              <div class="col-md-12 p-0">
                                  <button mat-stroked-button class="bg-white pl-12 text-custom"><img
                                          src="/assets/images/svg/attech-light.svg" class="pr-8">Fact
                                      sheet.pdf<img src="/assets/images/svg/s-cross.svg" class="pl-8"></button>

                              </div>
                              <div class="col-md-12 p-0">
                                  <button mat-stroked-button class="primary-sm mt-16">Edit</button>
                              </div>
                          </div>
                      </div>
                  </mat-tab>
              </mat-tab-group>
          </div>
      </div>
  </div> -->
  <div *ngIf="noMapping==true" class="pt-90 pr-20 pl-20 pb-44 text-center">
    <p>no mapping found</p>
    <button (click)="noMapFunction()" class="btn-primary addon v-middle" mat-stroked-button><i
      class="material-icons pr-8 v-middle">
      add
    </i>ADD
    </button>
  </div>
  <div *ngIf="noSubBroker==true" class="pt-90 pr-20 pl-20 pb-44 text-center">
    <p>no broker found</p>
    <button (click)="noBroakerFun()" class="btn-primary addon v-middle" mat-stroked-button><i
      class="material-icons pr-8 v-middle">
      add
    </i>ADD
    </button>
  </div>
  <div>
    <app-purchase-trasaction (changedValue)="getResponse($event)" *ngIf="transactionType=='PURCHASE'"
                             [data]='transactionData'></app-purchase-trasaction>
    <app-switch-transaction (changedValue)="getResponse($event)" *ngIf="transactionType=='SWITCH'"
                            [data]='transactionData'></app-switch-transaction>
    <app-redemption-transaction (changedValue)="getResponse($event)" *ngIf="transactionType=='REDEMPTION'"
                                [data]='transactionData'></app-redemption-transaction>
    <app-sip-transaction (changedValue)="getResponse($event)" *ngIf="transactionType=='SIP'"
                         [data]='transactionData'></app-sip-transaction>
    <app-stp-transaction (changedValue)="getResponse($event)" *ngIf="transactionType=='STP'"
                         [data]='transactionData'></app-stp-transaction>
    <app-swp-transaction (changedValue)="getResponse($event)" *ngIf="transactionType=='SWP'"
                         [data]='transactionData'></app-swp-transaction>
  </div>
  <div *ngIf="transactionType==undefined" class="bottom-fixed row pl-20 pr-20 w-65 d-flex align-items-center">

    <div class="col-md-4 p-0 d-flex align-item-center justifly-content-start">
      <h5 (click)="close()" class="mb-0  text-white c-p">Cancel</h5>
    </div>

    <div *ngIf="noSubBroker==false && noMapping==false "
         class="col-md-8 p-0 d-flex align-item-center justify-content-end">
      <button (click)="saveAndNext()" class="btn-green text-white" mat-button>NEXT</button>
    </div>
    <!--
    <div class="col-md-8 p-0 d-flex align-item-center justifly-content-end" *ngIf="formStep == 'step-3' && transactionType!=undefined">
        {{formStep}}
        <button class="br-0 text-success f-14" (click)="saveAndAddAnother()" mat-button mat-raised-button>
            SAVE & ADD ANOTHER
        </button>

        <button mat-button class="btn-green text-white" (click)="onAddTransaction()">
            SAVE & PROCEED
        </button>
    </div> -->

  </div>
</div>
