<!--Main invoice section-->
<div id="ui-invoice-pdf-documents" *ngIf="invoiceInSub=='invoiceSubscription' && showEdit==false">
    <div class="bg-white pt-120">
        <div class="row b-b">
            <div class="col-md-4 p-0">
                <div class="row">
                    <div class="col-md-5 pl-8 pt-4 pr-8">
                        <h4 class="mb-0 wrapper-8 pt-12">Invoices</h4>
                    </div>
                    <!-- <div class="col-md-7 text-right pt-4 right">
    <button class="btn-primary br-0 my-btn mt-4" mat-stroked-button><i class="material-icons">
        add
      </i></button>
  </div> -->
                </div>
            </div>
            <div class="col-md-8 bl-1 p-0">
                <div class="row ">
                    <div class="col-md-10">
                        <h3 class="f-400 wrapper-16 pl-8 mb-0">{{storeData.invoiceNumber}}</h3>
                    </div>
                    <div (click)="Close('close', false)" class="col-md-2">
                        <i class="material-icons text-right pt-16 c-p right">
                            clear
                        </i>
                    </div>
                </div>
            </div>
        </div>
        <div class="row pb-28">
            <div class="col-md-4 sticky-top p-0 max-height-100">
                <div (click)="passInvoice(strData,i,$event)" *ngFor="let strData of dataInvoices let i=index" [ngClass]="(strData.id==storeData.id)?'bg-grey lter':'b-b'" class="invoiceSpacing b-b c-p">
                    <div class="row">
                        <div class="col-md-8 pl-0">
                            <p class="m-0 f-15">{{strData.clientName}}</p>
                        </div>
                        <div class="col-md-4 text-right pr-8">
                            <p class="m-0 f-15">{{formatter(strData.finalAmount)}}</p>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-5 pl-0">
                            <p class="m-0 f-13 pt-12">{{strData.invoiceNumber}}</p>
                        </div>
                        <div class="col-md-2 p-0">
                            <p class="m-0 f-13 pt-12">{{strData.invoiceDate | date:'dd/MM/yyyy'}}</p>
                        </div>
                        <div class="col-md-5 text-right pr-8">
                            <p class="m-0 f-13 pt-12">
                                <span *ngIf="strData.status==0" class="text-primary t-10 f-500 c-p">UNPAID</span>
                                <span *ngIf="strData.status==1" class="text-success t-10 f-500 c-p">PAID</span>
                                <span *ngIf="strData.status==2" class="text-danger t-10 f-500 c-p">OVERDUE</span>
                                <span *ngIf="strData.status==3" class="text-warning t-10 f-500 c-p">PARTIALLY
                                    PAID</span>
                                <span *ngIf="strData.status==4" class="text-primary t-10 f-500 c-p">SENT</span>
                                <span *ngIf="strData.status==5" class="text-lighter t-10 f-500 c-p">VOID</span>
                                <span *ngIf="strData.status==6" class="text-balck t-10 f-500 c-p">WRITE OFF</span>
                            </p>
                        </div>
                    </div>
                </div>


            </div>
            <div class="col-md-8 p-0 bl-1 ">
                <div *ngIf="showRecord==false && feeCalc==false" class="row pt-16 pb-16">
                    <div class="col-md-6 text-custom">
                        <img (click)="editInvoice()" *ngIf="storeData.status != 1" class="c-p" matTooltip="Edit" src="assets/images/svg/pencil.svg">
                        <img (click)="openSendEmail(null)" class="b-a c-p" matTooltip="Email" src="assets/images/svg/mail-light.svg">
                        <img (click)="generatePdf()" class="b-a c-p" matTooltip="Download PDF" src="assets/images/svg/pdf-icons.svg">
                        <!-- <img matTooltip="Print" (click)="printPage(invoiceTemplate)" class="b-a c-p"
                src="assets/images/svg/printer.svg"> -->
                        <!-- <img matTooltip="Delete" (click)="deleteModal('INVOICE',storeData.id)"
                class="b-a wrapper-9 ml-8 c-p" src="assets/images/svg/delete.svg"> -->
                    </div>
                    <div [ngClass]="storeData.status !=1? 'col-md-4' : 'col-md-2'" class="right text-right">
                        <button (click)="recordPayment()" *ngIf="rpyment==true" class="btn-primary br-0 h-40" mat-stroked-button>RECORD
                            PAYMENT
                        </button>
                    </div>
                    <div *ngIf="storeData.status!=1" class="col-md-2 right text-right pl-0">
                        <mat-form-field>
                            <mat-select (selectionChange)="addStatus(storeData,$event)" [(ngModel)]="moreStatus" class="form-control br-0" id="sel1">
                                <mat-option [value]="''" disabled>More</mat-option>
                                <mat-option [value]="5">Void</mat-option>
                                <mat-option [value]="6">Write off</mat-option>
                            </mat-select>
                        </mat-form-field>
                    </div>
                </div>

                <div class="row">
                    <div class="col-md-12">
                        <table style="width: 100%; margin: 0px auto; border: 1px solid #dee5e7; " align="center" #invoiceTemplate *ngIf="showRecord==false && feeCalc==false">
                            <tr>
                                <td style="padding: 10px;border-right: 1px solid #dee5e7; " colspan="2">
                                    <table style="width: 100%">
                                        <tr>
                                            <td style="vertical-align: middle;">
                                                <h1 style="font-size: 40px; font-weight: 600; margin: 0px; color: #757575;">
                                                    INVOICE </h1>
                                            </td>
                                            <td style="text-align: right; vertical-align: top;">
                                                <img style="width: 200px;" [src]="storeData.logoUrl"> </td>
                                        </tr>
                                    </table>
                                </td>
                            </tr>
                            <tr>
                                <td colspan="2" style="padding: 10px;">
                                    <table style="width: 100%; margin-top: 30px;">
                                        <tr>
                                            <!-- Payee address -->
                                            <td style="vertical-align: top;">
                                                <h4 style="margin: 0px; font-size: 18px; color: #000000;">
                                                    {{storeData.billerName}}</h4>
                                                <p style="margin: 10px 0px 0px 0px; font-size: 14px; color: #757575;">
                                                    Biller address</p>
                                                <p style="color: #000000; font-size: 14px;">{{storeData.billerAddress}}
                                                </p>
                                            </td>
                                            <!-- Biller address -->
                                            <td style="vertical-align: top;">
                                                <h4 style="margin: 0px; font-size: 18px; color: #000000;">
                                                    {{storeData.clientName}}</h4>
                                                <p style="margin: 10px 0px 0px 0px; font-size: 14px; color: #757575;">
                                                    Payee address</p>
                                                <p style="color: #000000; font-size: 14px;">{{storeData.billingAddress}}
                                                </p>
                                            </td>
                                        </tr>
                                    </table>
                                </td>
                            </tr>

                            <tr>
                                <td colspan="2" style="padding: 10px;">
                                    <table style="width: 100%; margin-top: 20px;">
                                        <tr>
                                            <td style="vertical-align: top;">
                                                <p style="font-size: 16px; color: #000000;">
                                                    <span style="color: #757575;">Invoice no</span>: {{storeData.invoiceNumber}}
                                                </p>
                                                <p style="font-size: 14px; color: #000000;">
                                                    <span style="color: #757575;">Invoice date</span>: {{storeData.invoiceDate| date:'dd/MM/yyyy'}}
                                                </p>
                                            </td>

                                            <td style="text-align: right;">
                                                <span style="color: #008FFF; font-size: 36px;">
                                                    <span *ngIf="storeData.status==0">UNPAID</span>
                                                <span *ngIf="storeData.status==1">PAID</span>
                                                <span *ngIf="storeData.status==2">OVERDUE</span>
                                                <span *ngIf="storeData.status==3">PARTIALLY
                                                        PAID</span>
                                                <span *ngIf="storeData.status==4">SENT</span>
                                                <span *ngIf="storeData.status==5">VOID</span>
                                                <span *ngIf="storeData.status==6">WRITE OFF</span>
                                                </span>
                                            </td>
                                        </tr>
                                    </table>
                                </td>
                            </tr>

                            <tr>
                                <td colspan="2" style="padding: 10px;">
                                    <table style="width: 100%; border: 1px solid #dee5e7; margin-top: 20px;">
                                        <tr>
                                            <td style="padding: 16px; border-bottom: 1px solid #dee5e7; background: #F5F7F7;">
                                                Service Details </td>
                                            <td style="text-align: right; background: #F5F7F7; border-bottom: 1px solid #dee5e7; padding: 16px;">
                                                Amount</td>
                                        </tr>
                                        <tr>
                                            <td style="padding: 16px;">
                                                <h4 class="m-0 f-14">
                                                    {{(storeData.services.length > 0) ? storeData.services[0].serviceName : ''}}
                                                </h4>
                                                <span class="m-0 f-14 text-custom">
                                                    {{(storeData.services.length > 0) ? storeData.services[0].description : ''}}
                                                </span>
                                            </td>
                                            <td style="text-align: right; padding: 16px;"><span>&#8377;</span>
                                                <span [value]="storeData.subTotal" appFormatNumber>{{formatter(storeData.subTotal)}}</span>
                                            </td>
                                        </tr>
                                    </table>
                                </td>
                            </tr>

                            <tr>
                                <td style=" padding: 10px; border-right: 1px solid #dee5e7;">
                                    <table style="width: 30%; float: right; margin-top: 20px;">
                                        <tr>
                                            <td style="text-align: right; padding: 8px;font-size: 14px;">Sub total</td>
                                            <td style=" text-align: right; padding: 8px;font-size: 14px;">
                                                <span>&#8377;</span>
                                                <span [value]="storeData.subTotal" appFormatNumber>{{formatter(storeData.subTotal)}}</span>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td style=" text-align: right;padding: 8px;font-size: 14px;">Discount</td>
                                            <td style="text-align: right; padding: 8px;font-size: 14px;">
                                                <span>&#8377;</span>
                                                <span [value]="storeData.discount" appFormatNumber>{{formatter(storeData.discount)}}</span>
                                            </td>
                                        </tr>
                                        <tr *ngIf="storeData.igst!=0">
                                            <td style=" text-align: right;padding: 8px;font-size: 14px;">IGST ({{storeData.igst}}%)
                                            </td>
                                            <td style=" text-align: right;padding: 8px;font-size: 14px;">
                                                <span>&#8377;</span><span appFormatNumber [value]="(storeData.subTotal-storeData.discount)*18/100">₹{{formatter((storeData.subTotal - storeData.discount) * 18 / 100)}}</span>
                                            </td>
                                        </tr>
                                        <tr *ngIf="storeData.cgst!=0">
                                            <td style=" text-align: right;padding: 8px;font-size: 14px;"> CGST ({{storeData.cgst}}%)
                                            </td>
                                            <td style=" text-align: right;padding: 8px;font-size: 14px;">
                                                <span>&#8377;</span><span [value]="(storeData.subTotal-storeData.discount)*9/100" appFormatNumber>{{formatter((storeData.subTotal - storeData.discount) * 9 / 100)}}</span>
                                            </td>
                                        </tr>
                                        <tr *ngIf="storeData.sgst!=0">
                                            <td style=" text-align: right;padding: 8px;font-size: 14px;"> SGST ({{storeData.sgst}}%)
                                            </td>
                                            <td style=" text-align: right;padding: 8px;font-size: 14px;">
                                                <span>&#8377;</span><span [value]="(storeData.subTotal-storeData.discount)*9/100" appFormatNumber>{{formatter((storeData.subTotal - storeData.discount) * 9 / 100)}}</span>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td style="border-top: 1px solid #dee5e7; text-align: right; font-weight: 500; padding: 8px;font-size: 14px;">
                                                Total </td>
                                            <td style="border-top: 1px solid #dee5e7;text-align: right; font-weight: 500; padding: 8px;font-size: 14px;">
                                                <span>&#8377;</span><span [value]="storeData.finalAmount" appFormatNumber>{{formatter(storeData.finalAmount)}}</span>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td style="border-top: 1px solid #dee5e7;text-align: right; font-weight: 500; padding: 8px; border-bottom: 1px solid #dee5e7; font-size: 14px;">
                                                Balance due
                                            </td>
                                            <td style="border-top: 1px solid #dee5e7; text-align: right; font-weight: 500; padding: 8px; border-bottom: 1px solid #dee5e7;font-size: 14px; ">
                                                <span>&#8377;</span><span [value]="storeData.finalAmount" appFormatNumber>{{formatter(storeData.finalAmount)}}</span> </td>
                                        </tr>
                                    </table>
                                </td>
                            </tr>

                            <tr>
                                <td colspan="2">
                                    <hr style="border: 0.5px solid #dee5e7; margin-left: 10px;
                                    margin-right: 10px;
                                    margin-top: 30px;">
                                </td>
                            </tr>

                            <tr>
                                <td colspan="2" style="padding: 0px 10px 10px 10px; ">
                                    <table style="width: 100%; margin-top: 10px;">
                                        <tr>
                                            <td>
                                                <h4 style="margin: 0px; font-weight: normal; font-size: 14px;"> Footnote description
                                                </h4>
                                                <p style="margin: 0px; font-size: 12px;"> {{storeData.footnote}}</p>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td style="padding-top: 15px;">
                                                <h4 style="margin: 0px; font-weight: normal; font-size: 14px;"> Terms & conditions
                                                </h4>
                                                <p style="margin: 0px; font-size: 12px;"> {{storeData.terms}}</p>
                                            </td>
                                        </tr>
                                    </table>
                                </td>
                            </tr>





                        </table>


                        <!--  PDF INVOICE   -->


                        <table width="100%" style=" margin: 0px auto; border: 1px solid #dee5e7; " align="center" #invoiceTemplate *ngIf="showRecord==false && feeCalc==false" [hidden]="true" id="template">
                            <tr>
                                <td style="padding: 10px;border-right: 1px solid #dee5e7; " colspan="2">
                                    <table style="width: 100%">
                                        <tr>
                                            <td style="vertical-align: middle;">
                                                <h1 style="font-size: 40px; font-weight: 600; margin: 0px; color: #757575;">
                                                    INVOICE </h1>
                                            </td>
                                            <td style="text-align: right; vertical-align: top;">
                                                <img style="width: 200px;" [src]="storeData.logoUrl"> </td>
                                        </tr>
                                    </table>
                                </td>
                            </tr>
                            <tr>
                                <td colspan="2" style="padding: 10px;">
                                    <table style="width: 100%; margin-top: 30px;">
                                        <tr>
                                            <!-- Payee address -->
                                            <td style="vertical-align: top;">
                                                <h4 style="margin: 0px; font-size: 18px; color: #000000;">
                                                    {{storeData.billerName}}</h4>
                                                <p style="margin: 10px 0px 0px 0px; font-size: 14px; color: #757575;">
                                                    Biller address</p>
                                                <p style="color: #000000; font-size: 14px;">{{storeData.billerAddress}}
                                                </p>
                                            </td>
                                            <!-- Biller address -->
                                            <td style="vertical-align: top;">
                                                <h4 style="margin: 0px; font-size: 18px; color: #000000;">
                                                    {{storeData.clientName}}</h4>
                                                <p style="margin: 10px 0px 0px 0px; font-size: 14px; color: #757575;">
                                                    Payee address</p>
                                                <p style="color: #000000; font-size: 14px;">{{storeData.billingAddress}}
                                                </p>
                                            </td>
                                        </tr>
                                    </table>
                                </td>
                            </tr>

                            <tr>
                                <td colspan="2" style="padding: 10px;">
                                    <table style="width: 100%; margin-top: 20px;">
                                        <tr>
                                            <td style="vertical-align: top;">
                                                <p style="font-size: 16px; color: #000000;">
                                                    <span style="color: #757575;">Invoice no</span>: {{storeData.invoiceNumber}}
                                                </p>
                                                <p style="font-size: 14px; color: #000000;">
                                                    <span style="color: #757575;">Invoice date</span>: {{storeData.invoiceDate| date:'dd/MM/yyyy'}}
                                                </p>
                                            </td>

                                            <td style="text-align: right;">
                                                <span style="color: #008FFF; font-size: 36px;">
                                                    <span *ngIf="storeData.status==0">UNPAID</span>
                                                <span *ngIf="storeData.status==1">PAID</span>
                                                <span *ngIf="storeData.status==2">OVERDUE</span>
                                                <span *ngIf="storeData.status==3">PARTIALLY
                                                        PAID</span>
                                                <span *ngIf="storeData.status==4">SENT</span>
                                                <span *ngIf="storeData.status==5">VOID</span>
                                                <span *ngIf="storeData.status==6">WRITE OFF</span>
                                                </span>
                                            </td>
                                        </tr>
                                    </table>
                                </td>
                            </tr>

                            <tr>
                                <td colspan="2" style="padding: 10px;">
                                    <table style="width: 100%; border: 1px solid #dee5e7; margin-top: 20px;">
                                        <tr>
                                            <td style="padding: 16px; border-bottom: 1px solid #dee5e7; background: #F5F7F7;">
                                                Service Details </td>
                                            <td style="text-align: right; background: #F5F7F7; border-bottom: 1px solid #dee5e7; padding: 16px;">
                                                Amount</td>
                                        </tr>
                                        <tr>
                                            <td style="padding: 16px;">
                                                <h4 class="m-0 f-14">
                                                    {{(storeData.services.length > 0) ? storeData.services[0].serviceName : ''}}
                                                </h4>
                                                <span class="m-0 f-14 text-custom">
                                                    {{(storeData.services.length > 0) ? storeData.services[0].description : ''}}
                                                </span>
                                            </td>
                                            <td style="text-align: right; padding: 16px;"><span>&#8377;</span>
                                                <span [value]="storeData.subTotal" appFormatNumber>{{formatter(storeData.subTotal)}}</span>
                                            </td>
                                        </tr>
                                    </table>
                                </td>
                            </tr>

                            <tr>
                                <td style=" padding: 10px; border-right: 1px solid #dee5e7;">
                                    <table style="width: 30%; float: right; margin-top: 20px;">
                                        <tr>
                                            <td style="text-align: right; padding: 8px;font-size: 14px;">Sub total</td>
                                            <td style=" text-align: right; padding: 8px;font-size: 14px;">
                                                <span>&#8377;</span>
                                                <span [value]="storeData.subTotal" appFormatNumber>{{formatter(storeData.subTotal)}}</span>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td style=" text-align: right;padding: 8px;font-size: 14px;">Discount</td>
                                            <td style="text-align: right; padding: 8px;font-size: 14px;">
                                                <span>&#8377;</span>
                                                <span [value]="storeData.discount" appFormatNumber>{{formatter(storeData.discount)}}</span>
                                            </td>
                                        </tr>
                                        <tr *ngIf="storeData.igst!=0">
                                            <td style=" text-align: right;padding: 8px;font-size: 14px;">IGST ({{storeData.igst}}%)
                                            </td>
                                            <td style=" text-align: right;padding: 8px;font-size: 14px;">
                                                <span>&#8377;</span><span appFormatNumber [value]="(storeData.subTotal-storeData.discount)*18/100">₹{{formatter((storeData.subTotal - storeData.discount) * 18 / 100)}}</span>
                                            </td>
                                        </tr>
                                        <tr *ngIf="storeData.cgst!=0">
                                            <td style=" text-align: right;padding: 8px;font-size: 14px;"> CGST ({{storeData.cgst}}%)
                                            </td>
                                            <td style=" text-align: right;padding: 8px;font-size: 14px;">
                                                <span>&#8377;</span><span [value]="(storeData.subTotal-storeData.discount)*9/100" appFormatNumber>{{formatter((storeData.subTotal - storeData.discount) * 9 / 100)}}</span>
                                            </td>
                                        </tr>
                                        <tr *ngIf="storeData.sgst!=0">
                                            <td style=" text-align: right;padding: 8px;font-size: 14px;"> SGST ({{storeData.sgst}}%)
                                            </td>
                                            <td style=" text-align: right;padding: 8px;font-size: 14px;">
                                                <span>&#8377;</span><span [value]="(storeData.subTotal-storeData.discount)*9/100" appFormatNumber>{{formatter((storeData.subTotal - storeData.discount) * 9 / 100)}}</span>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td style="border-top: 1px solid #dee5e7; text-align: right; font-weight: 500; padding: 8px;font-size: 14px;">
                                                Total </td>
                                            <td style="border-top: 1px solid #dee5e7;text-align: right; font-weight: 500; padding: 8px;font-size: 14px;">
                                                <span>&#8377;</span><span [value]="storeData.finalAmount" appFormatNumber>{{formatter(storeData.finalAmount)}}</span>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td style="border-top: 1px solid #dee5e7;text-align: right; font-weight: 500; padding: 8px; border-bottom: 1px solid #dee5e7; font-size: 14px;">
                                                Balance due
                                            </td>
                                            <td style="border-top: 1px solid #dee5e7; text-align: right; font-weight: 500; padding: 8px; border-bottom: 1px solid #dee5e7;font-size: 14px; ">
                                                <span>&#8377;</span><span [value]="storeData.finalAmount" appFormatNumber>{{formatter(storeData.finalAmount)}}</span> </td>
                                        </tr>
                                    </table>
                                </td>
                            </tr>

                            <tr>
                                <td colspan="2">
                                    <table style="width: 100%">
                                        <tr>
                                            <td>
                                                <hr style="border: 0.5px solid #dee5e7; margin-left: 10px;
                                                    margin-right: 10px;
                                                    margin-top: 30px;">
                                            </td>
                                        </tr>
                                    </table>

                                </td>
                            </tr>

                            <tr>
                                <td colspan="2" style="padding: 0px 10px 10px 10px; ">
                                    <table style="width: 100%; margin-top: 10px;">
                                        <tr>
                                            <td>
                                                <h4 style="margin: 0px; font-weight: normal; font-size: 14px;"> Footnote description
                                                </h4>
                                                <p style="margin: 0px; font-size: 12px;"> {{storeData.footnote}}</p>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td style="padding-top: 15px;">
                                                <h4 style="margin: 0px; font-weight: normal; font-size: 14px;"> Terms & conditions
                                                </h4>
                                                <p style="margin: 0px; font-size: 12px;"> {{storeData.terms}}</p>
                                            </td>
                                        </tr>
                                    </table>
                                </td>
                            </tr>

                        </table>




                        <div *ngIf="storeData.feeCalculation" class="mt-10">
                            <div class="row b-a bg-grey lter ">
                                <div class="col-md-10 d-flex  align-items-center">
                                    <p class="m-0 text-black f-600  ">Fee calculation - Attachment</p>
                                </div>
                                <div class="col-md-2 wrapper-9 text-right">
                                    <button (click)="OpenFeeCalc()" class="btn-primary br-0" mat-stroked-button>View
                                    </button>
                                </div>
                            </div>
                        </div>

                        <div *ngIf="showPaymentRecive == true" class="row">
                            <div class="col-md-12 p-0">
                                <h3 class="mt-20 mb-20">Payments recieved</h3>
                            </div>
                        </div>

                        <table *ngIf="showPaymentRecive == true" [dataSource]="dataSource" class="" id="table-low" mat-table>
                            <ng-container matColumnDef="date">
                                <th *matHeaderCellDef mat-header-cell>Date</th>
                                <td *matCellDef="let element" mat-cell> {{element.paymentDate | date:'dd/MM/yyyy'}}
                                </td>
                            </ng-container>
                            <ng-container matColumnDef="reference">
                                <th *matHeaderCellDef mat-header-cell> Reference</th>
                                <td *matCellDef="let element" mat-cell> {{storeData.invoiceNumber}} </td>
                            </ng-container>
                            <ng-container matColumnDef="paymentMode">
                                <th *matHeaderCellDef mat-header-cell> Payment mode</th>
                                <td *matCellDef="let element" mat-cell> {{element.paymentMode}} </td>
                            </ng-container>
                            <ng-container matColumnDef="amount">
                                <th *matHeaderCellDef mat-header-cell> Amount(₹)</th>
                                <td *matCellDef="let element" mat-cell><span appFormatNumber>{{element.amountReceived}}</span></td>
                            </ng-container>
                            <ng-container matColumnDef="icons">
                                <th *matHeaderCellDef class="f-18 t-2" mat-header-cell></th>
                                <td *matCellDef="let element" class="t-2" mat-cell>
                                    <i [matMenuTriggerFor]="menu" class="material-icons c-p iconscolors">
                                        more_vert
                                    </i>
                                    <mat-menu #menu="matMenu">
                                        <a (click)="editForm(element)" mat-menu-item>Edit</a>
                                    </mat-menu>
                                </td>
                            </ng-container>
                            <tr *matHeaderRowDef="displayedColumns" mat-header-row></tr>
                            <tr *matRowDef="let row; columns: displayedColumns;" mat-row></tr>
                        </table>

                    </div>
                </div>


                <!--record payment div start-->
                <div *ngIf="showRecord==true">
                    <app-record-payment (outputData)='display($event)' [InvRecordData]="sendRecordPaymentData" [selectedInvRecord]="selectedInvRecord" [padding]="false">
                    </app-record-payment>
                </div>
                <!--Fee calculation Div start-->
                <div *ngIf="feeCalc==true">
                    <app-fee-calculations [padding]="false"></app-fee-calculations>
                </div>
            </div>
        </div>
    </div>
</div>
<!--Invoices in client Section-->
<div *ngIf="invoiceInSub!='invoiceSubscription'&& showEdit==false">
    <div class="row bb-1 popup-header-fix-60">
        <div class="col-md-10 pl-0">
            <h4 class="f-400 wrapper-20 mb-0">{{storeData.invoiceNumber}}</h4>
        </div>
        <div class="col-md-2">
            <i (click)="Close('close', false)" class="material-icons text-right pt-16 pr-16 c-p right">
                clear
            </i>
        </div>
    </div>
    <div *ngIf="showRecord==false && feeCalc==false" class="row pt-72">
        <div class="col-md-6 text-custom ">
            <img (click)="editInvoice()" *ngIf="storeData.isAdvisor && storeData.status != 1" class="c-p" matTooltip="Edit" src="assets/images/svg/pencil.svg">
            <img (click)="openSendEmail('upper')" *ngIf="storeData.isAdvisor" class="b-a c-p" matTooltip="Email" src="assets/images/svg/mail-light.svg">
            <img *ngIf="storeData.isAdvisor" (click)="generatePdf()" class="b-a c-p" matTooltip="Download PDF" src="assets/images/svg/pdf-icons.svg">
            <!-- <img matTooltip="Print" (click)="printPage(invoiceTemplate)" class="b-a c-p"
          src="assets/images/svg/printer.svg">
      <img matTooltip="Delete" (click)="deleteModal('INVOICE',element)" class="b-a wrapper-9 ml-8 c-p"
          *ngIf="storeData.isAdvisor" src="assets/images/svg/delete.svg"> -->
        </div>
        <div *ngIf="storeData.isAdvisor" [ngClass]="storeData.status !=1? 'col-md-4' : 'col-md-5'" class="right text-right">
            <button (click)="recordPayment()" *ngIf="rpyment==true" class="btn-primary br-0 mb-8 h-40" mat-stroked-button>RECORD
                PAYMENT
            </button>
        </div>
        <div *ngIf="storeData.isAdvisor && storeData.status!=1" class="col-md-2 right text-right pl-0">
            <mat-form-field>
                <mat-select (selectionChange)="addStatus(storeData,$event)" [(ngModel)]="moreStatus" class="form-control br-0" id="sel1">
                    <mat-option [value]="''" disabled selected>More</mat-option>
                    <mat-option [value]="5">Void</mat-option>
                    <mat-option [value]="6">Write off</mat-option>
                </mat-select>
            </mat-form-field>
        </div>
    </div>

    <div class="row">
        <div class="col-md-12">


            <table style="width: 100%; margin: 0px auto; border: 1px solid #dee5e7; padding: 10px; " align="center" #invoiceTemplate *ngIf="showRecord==false && feeCalc==false" id="template">
                <tr>
                    <td colspan="2" style="padding: 8px;">
                        <table style="width: 100%">
                            <tr>
                                <td style="vertical-align: middle;">
                                    <h1 style="font-size: 40px; font-weight: 600; margin: 0px; color: #757575;">INVOICE
                                    </h1>
                                </td>
                                <td style="text-align: right; vertical-align: top;">
                                    <img style="width: 200px;" [src]="storeData.logoUrl"> </td>
                            </tr>
                        </table>
                    </td>
                </tr>
                <tr>
                    <td colspan="2" style="padding: 8px;">
                        <table style="width: 100%; margin-top: 30px;">
                            <tr>
                                <td style="vertical-align: top;">
                                    <h4 style="margin: 0px; font-size: 18px; color: #000000;">{{storeData.billerName}}
                                    </h4>
                                    <p style="margin: 10px 0px 0px 0px; font-size: 14px; color: #757575;">Biller address
                                    </p>
                                    <p style="color: #000000; font-size: 14px;">{{storeData.billerAddress}}</p>
                                </td>

                                <td style="vertical-align: top;">
                                    <h4 style="margin: 0px; font-size: 18px; color: #000000;">{{storeData.clientName}}
                                    </h4>
                                    <p style="margin: 10px 0px 0px 0px; font-size: 14px; color: #757575;">Payee address.
                                    </p>
                                    <p style="color: #000000; font-size: 14px;">{{storeData.billingAddress}}</p>
                                </td>
                            </tr>
                        </table>
                    </td>
                </tr>

                <tr>
                    <td style="padding: 8px;" colspan="2">
                        <table style="width: 100%; margin-top: 20px;">
                            <tr>
                                <td style="vertical-align: top;">
                                    <p style="font-size: 16px; color: #000000;">
                                        <span style="color: #757575;">Invoice no</span>: {{storeData.invoiceNumber}}
                                    </p>
                                    <p style="font-size: 14px; color: #000000;">
                                        <span style="color: #757575;">Invoice date</span>: {{storeData.invoiceDate| date:'dd/MM/yyyy'}}
                                    </p>
                                </td>

                                <td style="text-align: right;">
                                    <span style="color: #008FFF; font-size: 36px;">
                                        <span *ngIf="storeData.status==0">UNPAID</span>
                                    <span *ngIf="storeData.status==1">PAID</span>
                                    <span *ngIf="storeData.status==2">OVERDUE</span>
                                    <span *ngIf="storeData.status==3">PARTIALLY
                                            PAID</span>
                                    <span *ngIf="storeData.status==4">SENT</span>
                                    <span *ngIf="storeData.status==5">VOID</span>
                                    <span *ngIf="storeData.status==6">WRITE OFF</span>
                                    </span>
                                </td>
                            </tr>
                        </table>
                    </td>
                </tr>

                <tr>
                    <td colspan="2" style="padding: 8px;">
                        <table style="width: 100%; border: 1px solid #dee5e7; margin-top: 20px;">
                            <tr>
                                <td style="padding: 16px; border-bottom: 1px solid #dee5e7; background: #F5F7F7;">
                                    Service Details </td>
                                <td style="text-align: right; background: #F5F7F7; border-bottom: 1px solid #dee5e7; padding: 16px;">
                                    Amount</td>
                            </tr>
                            <tr>
                                <td style="padding: 16px;">
                                    <h4 class="m-0 f-14">
                                        {{(storeData.services.length > 0) ? storeData.services[0].serviceName : ''}}
                                    </h4>
                                    <span class="m-0 f-14 text-custom">
                                        {{(storeData.services.length > 0) ? storeData.services[0].description : ''}}
                                    </span>
                                </td>
                                <td style="text-align: right; padding: 16px;"><span>&#8377;</span>
                                    <span [value]="storeData.subTotal" appFormatNumber>{{formatter(storeData.subTotal)}}</span>
                                </td>
                            </tr>
                        </table>
                    </td>
                </tr>

                <tr>
                    <td style="padding: 8px; ">

                        <table style="width: 30%; float: right; margin-top: 20px;">
                            <tr>
                                <td style="text-align: right; padding: 8px;font-size: 14px;">Sub total</td>
                                <td style=" text-align: right; padding: 8px;font-size: 14px;"><span>&#8377;</span>
                                    <span [value]="storeData.subTotal" appFormatNumber>{{formatter(storeData.subTotal)}}</span>
                                </td>
                            </tr>
                            <tr>
                                <td style=" text-align: right;padding: 8px;font-size: 14px;">Discount</td>
                                <td style="text-align: right; padding: 8px;font-size: 14px;"><span>&#8377;</span>
                                    <span [value]="storeData.discount" appFormatNumber>{{formatter(storeData.discount)}}</span>
                                </td>
                            </tr>
                            <tr *ngIf="storeData.igst!=0">
                                <td style=" text-align: right;padding: 8px;font-size: 14px;">IGST ({{storeData.igst}}%)
                                </td>
                                <td style=" text-align: right;padding: 8px;font-size: 14px;"> <span>&#8377;</span><span appFormatNumber [value]="(storeData.subTotal-storeData.discount)*18/100">₹{{formatter((storeData.subTotal - storeData.discount) * 18 / 100)}}</span>
                                </td>
                            </tr>
                            <tr *ngIf="storeData.cgst!=0">
                                <td style=" text-align: right;padding: 8px;font-size: 14px;"> CGST ({{storeData.cgst}}%)
                                </td>
                                <td style=" text-align: right;padding: 8px;font-size: 14px;"> <span>&#8377;</span><span [value]="(storeData.subTotal-storeData.discount)*9/100" appFormatNumber>{{formatter((storeData.subTotal - storeData.discount) * 9 / 100)}}</span>
                                </td>
                            </tr>
                            <tr *ngIf="storeData.sgst!=0">
                                <td style=" text-align: right;padding: 8px;font-size: 14px;"> SGST ({{storeData.sgst}}%)
                                </td>
                                <td style=" text-align: right;padding: 8px;font-size: 14px;"> <span>&#8377;</span><span [value]="(storeData.subTotal-storeData.discount)*9/100" appFormatNumber>{{formatter((storeData.subTotal - storeData.discount) * 9 / 100)}}</span>
                                </td>
                            </tr>
                            <tr>
                                <td style="border-top: 1px solid #dee5e7; text-align: right; font-weight: 500; padding: 8px;font-size: 14px;">
                                    Total </td>
                                <td style="border-top: 1px solid #dee5e7;text-align: right; font-weight: 500; padding: 8px;font-size: 14px;">
                                    <span>&#8377;</span><span [value]="storeData.finalAmount" appFormatNumber>{{formatter(storeData.finalAmount)}}</span>
                                </td>
                            </tr>
                            <tr>
                                <td style="border-top: 1px solid #dee5e7;text-align: right; font-weight: 500; padding: 8px; border-bottom: 1px solid #dee5e7; font-size: 14px;">
                                    Balance due
                                </td>
                                <td style="border-top: 1px solid #dee5e7; text-align: right; font-weight: 500; padding: 8px; border-bottom: 1px solid #dee5e7;font-size: 14px; ">
                                    <span>&#8377;</span><span [value]="storeData.finalAmount" appFormatNumber>{{formatter(storeData.finalAmount)}}</span> </td>
                            </tr>
                        </table>
                    </td>

                    <tr>
                        <td>
                            <table style="width: 100%; margin-bottom: 15px; margin-top: 10px;">
                                <tr>
                                    <td style="padding-left: 10px;">
                                        <h4 style="margin: 0px; font-weight:normal; font-size: 14px;"> Footnote description
                                        </h4>
                                        <p style="margin: 0px; font-size: 12px;"> {{storeData.footnote}}</p>
                                    </td>
                                </tr>

                                <tr>
                                    <td style="padding-left: 10px; padding-top: 10px;">
                                        <h4 style="margin: 0px; font-weight:normal; font-size: 14px;"> Terms & conditions
                                        </h4>
                                        <p style="margin: 0px; font-size: 12px;"> {{storeData.terms}}</p>
                                    </td>
                                </tr>

                            </table>
                        </td>
                    </tr>
            </table>

            <div *ngIf="storeData.feeCalculation" class="mt-10 vaibahv">
                <div class="row b-a bg-grey lter">
                    <div class="col-md-10 d-flex  align-items-center">
                        <p class="m-0 text-black f-600 ">Fee calculation - Attachment</p>
                    </div>
                    <div class="col-md-2 wrapper-9 text-right">
                        <button (click)="OpenFeeCalc()" class="btn-primary br-0" mat-stroked-button>View
                        </button>
                    </div>
                </div>
            </div>

            <div *ngIf="showPaymentRecive == true" class="row">
                <div class="col-md-12 p-0">
                    <h3 class="mt-20 mb-20">Payments recieved</h3>
                </div>
            </div>


            <table *ngIf="showPaymentRecive == true" [dataSource]="dataSource" class="" id="table-low" mat-table>
                <ng-container matColumnDef="date">
                    <th *matHeaderCellDef mat-header-cell>Date</th>
                    <td *matCellDef="let element" mat-cell> {{element.paymentDate | date:'dd/MM/yyyy'}}
                    </td>
                </ng-container>
                <ng-container matColumnDef="reference">
                    <th *matHeaderCellDef mat-header-cell> Reference</th>
                    <td *matCellDef="let element" mat-cell> {{storeData.invoiceNumber}} </td>
                </ng-container>
                <ng-container matColumnDef="paymentMode">
                    <th *matHeaderCellDef mat-header-cell> Payment mode</th>
                    <td *matCellDef="let element" mat-cell> {{element.paymentMode}} </td>
                </ng-container>
                <ng-container matColumnDef="amount">
                    <th *matHeaderCellDef mat-header-cell> Amount(₹)</th>
                    <td *matCellDef="let element" mat-cell><span appFormatNumber>{{element.amountReceived}}</span></td>
                </ng-container>
                <ng-container matColumnDef="icons">
                    <th *matHeaderCellDef class="f-18 t-2" mat-header-cell></th>
                    <td *matCellDef="let element" class="t-2" mat-cell>
                        <i [matMenuTriggerFor]="menu" class="material-icons c-p iconscolors">
                            more_vert
                        </i>
                        <mat-menu #menu="matMenu">
                            <a (click)="editForm(element)" mat-menu-item>Edit</a>
                        </mat-menu>
                    </td>
                </ng-container>
                <tr *matHeaderRowDef="displayedColumns" mat-header-row></tr>
                <tr *matRowDef="let row; columns: displayedColumns;" mat-row></tr>
            </table>

        </div>
    </div>

    <!--show record in client invoice-->
    <div *ngIf="showRecord==true" class="pt-72">
        <app-record-payment (outputData)='display($event)' [InvRecordData]="sendRecordPaymentData" [padding]="true">
        </app-record-payment>
    </div>
    <!--fee calc in client invoice-->
    <div *ngIf="feeCalc==true">
        <app-fee-calculations [feeAmount]="storeData.subTotal" [feeCalculationData]="invoiceFeeCalculations" [padding]="true"></app-fee-calculations>
    </div>
    <!-- <div class="bottom-fixed wrapper-12">
      <div class="row">
          <div class="col-md-12">
              <h5 (click)="Close('close', false)" class="mb-0 pt-8 pb-8 text-white c-p">Cancel</h5>
          </div>
      </div>
  </div> -->
</div>
<!--Add and edit invoice section-->
<div *ngIf="showEdit" [ngClass]="!inputData?'pt-60':''">
    <app-add-edit-subscription-invoice (cancelAddInvoice)="getAddCancelFlag($event)" (cancelEditInvoice)="getCancelFlag($event)" (valueChange)='display($event)' [data]="storeData" [invoiceInSub]="invoiceInSub" [invoiceValue]="invoiceValue">
    </app-add-edit-subscription-invoice>
</div>