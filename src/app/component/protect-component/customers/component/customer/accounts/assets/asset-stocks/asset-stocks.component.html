<div class="wrapper-8 pb-44 asset-stocks">
    <!-- <div class="row">
 <div class="col-md-12 right text-right pt-28 pb-28 pr-0">
   <button [matMenuTriggerFor]="menu" class="ba-black br-0" mat-stroked-button>
     Overview Report
     <mat-icon aria-hidden="false" aria-label="Example home icon">keyboard_arrow_down</mat-icon>
   </button>
   <mat-menu #menu="matMenu">
     <button mat-menu-item>Overview Report</button>
     <button mat-menu-item>Summary</button>
     <button mat-menu-item>All Transactions</button>
     <button mat-menu-item>Unrealized Transactions</button>
     <button mat-menu-item>Capital Gains</button>
     <button mat-menu-item>Goal Linkage</button>
   </mat-menu>
 </div>
</div> -->
    <div class="row pt-24" #tableEl>
        <div class="col-md-4 p-0">
            <h4 class="m-0 text-black roboto pt-8">Stocks overview</h4>
        </div>
        <div *ngIf="portfolioData.length > 0" class="col-md-8 p-0 d-flex justify-content-end">
            <a [matMenuTriggerFor]="menu5" class="c-p downloadPdfIcon mr-10" *ngIf="!fragmentData.isSpinner">
                <img src="assets/images/svg/download-bordered.svg">
            </a>
            <mat-menu #menu5="matMenu">
                <button (click)="generatePdf()" mat-menu-item>PDF</button>
                <!-- <button (click)="Excel('Bonds')" mat-menu-item>XLS</button> -->
            </mat-menu>
            <mat-spinner [diameter]="30" *ngIf="fragmentData.isSpinner"></mat-spinner>
            <!-- <img src="assets/images/svg/up-down.svg" class="c-p">
            <img src="assets/images/svg/three-dot-bordered.svg" class="c-p mr-12">
            <button mat-stroked-button class="btn-default addon mr-12 v-middle"><i
          class="material-icons">filter_list</i>FILTERS  -->
       
            <button mat-stroked-button class="btn-primary addon v-middle" [matMenuTriggerFor]="menu1">
                ADD NEW
            </button>
            <mat-menu #menu1="matMenu" class="add-new">
                <button (click)="openAddStock('addPortfolio',null)" mat-menu-item class="b-b">
                    <div class="row">
                        <div class="col-md-2 pr-8 text-right">
                            <img src="assets/images/svg/dark-three-dot.svg">
                        </div>
                        <div class="col-md-10">
                            <p class="m-0 text-black">Portfolio summary</p>
                            <p class="m-0 f-13 pt-4 text-custom">Add just the overall portfolio
                                <br> summary. Time saver!
                            </p>
                        </div>
                    </div>
                </button>
                <button (click)="openAddStock('holding',null)" mat-menu-item class="b-b">
                    <div class="row">
                        <div class="col-md-2 pr-8 text-right">
                            <img src="assets/images/svg/dark-download.svg">
                        </div>
                        <div class="col-md-10">
                            <p class="m-0 text-black">Scrip level holdings</p>
                            <p class="m-0 pt-4 f-13 text-custom">Add holding data at
                                <br> Scrip level for better reporting
                            </p>
                        </div>
                    </div>
                </button>
                <button (click)="openAddStock('transaction',null)" mat-menu-item class="b-b">
                    <div class="row">
                        <div class="col-md-2 pr-8 text-right">
                            <img src="assets/images/svg/scheme-icon.svg">
                        </div>
                        <div class="col-md-10">
                            <p class="m-0 text-black">Scrip level transactions</p>
                            <p class="m-0 pt-4 f-13 text-custom">Add transaction data at
                                <br> Scrip level for better reporting
                            </p>
                        </div>
                    </div>
                </button>
            </mat-menu>
        </div>
    </div>


    <div *ngIf="portfolioData.length > 0 || isLoading" class="skeletonAnimation " appSkeletonLoading
        [appSkeletonLoading]="isLoading">
        <div class="overflow-y-1200">
            <div class="row pt-12 w-1024">
                <div class="col-md-5 pl-0 pr-4">
                    <div class="row b-a" #summery>
                        <div class="col-md-12 bg-grey lter p-0">
                            <h5 class="mb-0 wrapper-8 pt-12 pb-16 text-black b-b">Summary </h5>
                        </div>
                        <div class="col-md-12 p-0">
                            <p class="m-0 text-custom pt-16 pl-8 roboto">Current value</p>
                            <div class="relClass">
                                <div class="bar" [ngClass]="{'height24': isLoading}">
                                    <h2 *ngIf="assetStockData && !isLoading"
                                        class="m-0 f-300 text-black pt-4 pl-8 pb-24">
                                        ₹<span [value]="grandTotalCurrentValue"
                                            appFormatNumber>{{grandTotalCurrentValue}}</span>
                                    </h2>
                                    <h2 *ngIf="!assetStockData && !isLoading"
                                        class="m-0 f-300 text-black pt-4 pl-8 pb-24">
                                        ₹0</h2>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-12 p-0">
                            <div class="row bg-light lter pt-20 pb-20 bt-1">
                                <div class="col-md-4 pr-0 pl-12">
                                    <p class="text-custom m-0 roboto"> Amount invested</p>
                                    <div class="relClass">
                                        <div class="bar" [ngClass]="{'height24': isLoading}">
                                            <h5 *ngIf="assetStockData && !isLoading" class="m-0 text-black">
                                                ₹<span [value]="grandTotalAmountInvested" appFormatNumber></span>
                                            </h5>
                                            <h5 *ngIf="!assetStockData && !isLoading" class="m-0 text-black">
                                                ₹0
                                            </h5>
                                        </div>
                                    </div>

                                </div>
                                <div class="col-md-5 pr-0 pl-12">
                                    <p class="text-custom m-0 roboto"> Unrealized gain/loss</p>
                                    <div class="relClass">
                                        <div class="bar" [ngClass]="{'height24': isLoading}">
                                            <h5 *ngIf="assetStockData && !isLoading" class="m-0"
                                                [ngClass]="gain?'textGreen':'text-danger'">
                                                ₹<span [value]="assetStockData.grandTotalUnrealizedGainLoss"
                                                    appFormatNumber>{{assetStockData.grandTotalUnrealizedGainLoss}}</span>
                                            </h5>
                                            <h5 *ngIf="!assetStockData && !isLoading" class="m-0 text-danger">
                                                ₹0
                                            </h5>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-3 pr-0 pl-12">
                                    <p class="text-custom m-0 roboto"> Returns </p>
                                    <div class="relClass">
                                        <div class="bar" [ngClass]="{'height24': isLoading}">
                                            <h5 *ngIf="assetStockData && !isLoading" class="m-0"
                                                [ngClass]="gain?'textGreen':'text-danger'">
                                                <span>{{assetStockData.grandTotalAbsReturns?assetStockData.grandTotalAbsReturns:0}}{{assetStockData.grandTotalAbsReturns?'%':''}}</span>
                                                <i class="material-icons v-sub f-18 f-700 textGreen" *ngIf="gain">
                                                    arrow_upward
                                                </i>
                                                <i class="material-icons v-sub f-18 f-700 text-danger" *ngIf="!gain">
                                                    arrow_downward
                                                </i>
                                            </h5>
                                            <h5 *ngIf="!assetStockData && !isLoading" class="m-0 text-danger">
                                                0%
                                            </h5>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="col-md-7 pl-4 pr-0"
                    *ngIf="(categories.Banks && categories.Banks.currentValue != 0) || (categories.fmcg && categories.fmcg.currentValue != 0) || (categories.Auto_Ancillaries && categories.Auto_Ancillaries.currentValue != 0) || (categories.OTHERS && categories.OTHERS.currentValue != 0)">
                    <div class="row">
                        <div class="col-md-4 p-0 b-a"
                            *ngIf="(categories.Banks && categories.Banks.currentValue != 0) || (categories.fmcg && categories.fmcg.currentValue != 0) || (categories.Auto_Ancillaries && categories.Auto_Ancillaries.currentValue != 0)|| (categories.OTHERS && categories.OTHERS.currentValue != 0)">
                            <div class="relClass">
                                <div class="bar227" [ngClass]="{'height227': isLoading}">
                                    <div *ngIf="!isLoading">
                                        <div #PaiChart class="highcharts-figure" id="piechartStock"></div>
                                    </div>
                                </div>
                            </div>
                        </div>



                        <div *ngIf="isLoading" class="col-md-8 b-a ">
                            <div class="relClass mt-28 mb-10">
                                <div class="bar" [ngClass]="{'height24': isLoading}"> </div>
                            </div>
                            <div class="relClass mb-10">
                                <div class="bar" [ngClass]="{'height24': isLoading}"> </div>
                            </div>
                            <div class="relClass mb-10">
                                <div class="bar" [ngClass]="{'height24': isLoading}"> </div>
                            </div>
                            <div class="relClass mb-10">
                                <div class="bar" [ngClass]="{'height24': isLoading}"> </div>
                            </div>
                            <div class="relClass mb-10">
                                <div class="bar" [ngClass]="{'height24': isLoading}"> </div>
                            </div>
                        </div>



                        <div #categoriesL *ngIf="!isLoading" class=" b-a p-0 height227 d-flex justify-content-center flex-column"
                            [ngClass]="(categories.Banks && categories.Banks.currentValue != 0) || (categories.fmcg && categories.fmcg.currentValue != 0) || (categories.Auto_Ancillaries && categories.Auto_Ancillaries.currentValue != 0) || (categories.OTHERS && categories.OTHERS.currentValue != 0)?'col-md-8':'col-md-12'"
                            [ngStyle]="{'border-left':(categories.Banks && categories.Banks.currentValue != 0) || (categories.fmcg && categories.fmcg.currentValue != 0) || (categories.Auto_Ancillaries && categories.Auto_Ancillaries.currentValue != 0) || (categories.OTHERS && categories.OTHERS.currentValue != 0)? 'none':''}">
                            <div class="row bb pt-10 pb-10" *ngIf="categories.Banks.perrcentage > 0">
                                <div class="col-md-1">
                                    <div class="hw-16 mt-2 bg-Banking"></div>
                                </div>
                                <div class="col-md-6">
                                    <p class="f-500 text-black mb-0">Banking</p>
                                </div>
                                <div class="col-md-3 pl-0 text-right" *ngIf="categories.Banks != undefined">
                                    <!-- <p class="text-black mb-0">23.43%</p> -->
                                    <div class="relClass">
                                        <div class="bar" [ngClass]="{'height24': isLoading}">
                                            <div *ngIf="!isLoading">
                                                {{categories.Banks?'₹':''}}<span [value]="categories.Banks.currentValue"
                                                    appFormatNumber>{{categories.Banks.currentValue}}</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-2 pl-0" *ngIf="categories.Banks != undefined">
                                    <!-- <p class="text-black mb-0">23.43%</p> -->
                                    <div class="relClass">
                                        <div class="bar" [ngClass]="{'height24': isLoading}">
                                            <div *ngIf="!isLoading">
                                                <p class="text-black mb-0">
                                                    {{categories.Banks.perrcentage | number: '1.2-2'}}{{categories.Banks?'%':''}}
                                                </p>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="row b-t pt-10 pb-10" *ngIf="categories.Information_Technology.perrcentage > 0">
                                <div class="col-md-1">
                                    <div class="hw-16 mt-2 bg-technology"></div>
                                </div>
                                <div class="col-md-6">
                                    <p class="f-500 text-black mb-0">Information technology</p>
                                </div>

                                <div class="col-md-3 pl-0 text-right"
                                    *ngIf="categories.Information_Technology != undefined">
                                    <!-- <p class="text-black mb-0">23.43%</p> -->
                                    <div class="relClass">
                                        <div class="bar" [ngClass]="{'height24': isLoading}">
                                            <div *ngIf="!isLoading">
                                                {{categories.Information_Technology?'₹':''}}<span
                                                    [value]="categories.Information_Technology.currentValue"
                                                    appFormatNumber>{{categories.Information_Technology.currentValue}}</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <div class="col-md-2 pl-0" *ngIf="categories.Information_Technology != undefined">
                                    <!-- <p class="text-black mb-0">23.43%</p> -->
                                    <div class="relClass">
                                        <div class="bar" [ngClass]="{'height24': isLoading}">
                                            <p class="text-black mb-0" *ngIf="!isLoading">
                                                {{categories.Information_Technology.perrcentage | number: '1.2-2'}}{{categories.Information_Technology?'%':''}}
                                            </p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="row b-t pt-10 pb-10" *ngIf="categories.fmcg.perrcentage > 0">
                                <div class="col-md-1">
                                    <div class="hw-16 mt-2 bg-FMCG"></div>
                                </div>
                                <div class="col-md-6">
                                    <p class="f-500 text-black mb-0">FMCG</p>
                                </div>
                                <div class="col-md-3 pl-0 text-right" *ngIf="categories.fmcg != undefined">
                                    <!-- <p class="text-black mb-0">23.43%</p> -->
                                    <div class="relClass">
                                        <div class="bar" [ngClass]="{'height24': isLoading}">
                                            <div *ngIf="!isLoading">
                                                {{categories.fmcg?'₹':''}}<span [value]="categories.fmcg.currentValue"
                                                    appFormatNumber>{{categories.fmcg.currentValue}}</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-2 pl-0" *ngIf="categories.fmcg != undefined">
                                    <!-- <p class="text-black mb-0">23.43%</p> -->
                                    <div class="relClass">
                                        <div class="bar" [ngClass]="{'height24': isLoading}">
                                            <p class="text-black mb-0" *ngIf="!isLoading">
                                                {{categories.fmcg.perrcentage | number: '1.2-2'}}{{categories.fmcg?'%':''}}
                                            </p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="row b-t pt-10 pb-10" *ngIf="categories.Auto_Ancillaries.perrcentage > 0">
                                <div class="col-md-1">
                                    <div class="hw-16 mt-2 bg-danger"></div>
                                </div>
                                <div class="col-md-6">
                                    <p class="f-500 text-black mb-0">Auto ancillaries</p>
                                </div>
                                <div class="col-md-3 pl-0 text-right" *ngIf="categories.Auto_Ancillaries != undefined">
                                    <!-- <p class="text-black mb-0">23.43%</p> -->
                                    <div class="relClass">
                                        <div class="bar" [ngClass]="{'height24': isLoading}">
                                            <div *ngIf="!isLoading">
                                                {{categories.Auto_Ancillaries?'₹':''}}<span
                                                    [value]="categories.Auto_Ancillaries.currentValue"
                                                    appFormatNumber>{{categories.Auto_Ancillaries.currentValue}}</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-2 pl-0" *ngIf="categories.Auto_Ancillaries != undefined">
                                    <!-- <p class="text-black mb-0">23.43%</p> -->
                                    <div class="relClass">
                                        <div class="bar" [ngClass]="{'height24': isLoading}">
                                            <p class="text-black mb-0" *ngIf="!isLoading">
                                                {{categories.Auto_Ancillaries.perrcentage | number: '1.2-2'}}{{categories.Auto_Ancillaries?'%':''}}
                                            </p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="row b-t pt-10 pb-10" *ngIf="categories.OTHERS.perrcentage > 0">
                                <div class="col-md-1">
                                    <div class="hw-16 mt-2 bg-grey dker"></div>
                                </div>
                                <div class="col-md-6">
                                    <p class="f-500 text-black mb-0">Others</p>
                                </div>
                                <div class="col-md-3 pl-0 text-right" *ngIf="categories.OTHERS">
                                    <!-- <p class="text-black mb-0">23.43%</p> -->
                                    <div class="relClass">
                                        <div class="bar" [ngClass]="{'height24': isLoading}">
                                            <div *ngIf="!isLoading">
                                                {{categories.OTHERS?'₹':''}}<span
                                                    [value]="categories.OTHERS.currentValue"
                                                    appFormatNumber>{{categories.OTHERS.currentValue}}</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-2 pl-0" *ngIf="categories.OTHERS">
                                    <!-- <p class="text-black mb-0">23.43%</p> -->
                                    <div class="relClass">
                                        <div class="bar" [ngClass]="{'height24': isLoading}">
                                            <p class="text-black mb-0" *ngIf="!isLoading">
                                                {{categories.OTHERS.perrcentage | number: '1.2-2'}}{{categories.OTHERS?'%':''}}
                                            </p>
                                        </div>
                                    </div>
                                </div>
                            </div>

                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div *ngIf="portfolioData.length > 0">
            <div   *ngFor="let singlePortfolio of portfolioData" class="row pt-12">
                <div class="col-md-12 p-0">
                    <div class="bg-white">
                        <h5 class="m-0 wrapper-8 b-a bb-0 text-primary">{{singlePortfolio.portfolioName}} |
                            {{singlePortfolio.ownerList.length > 0?singlePortfolio.ownerList[0].name:''}}
                        </h5>
                    </div>
                </div>

                <div class="stock-overview w-100" >
                    <table  [dataSource]="singlePortfolio.stockListGroup " mat-table id="table-low">

                        <ng-container matColumnDef="groupHeader" sticky>
                            <td *matCellDef="let group" [attr.colspan]="displayedColumns25.length"
                                class="text-center text-primary f-500">
                                {{group.group}}</td>
                        </ng-container>
                        <ng-container matColumnDef="scrip">
                            <th *matHeaderCellDef="let element let i = index" class="br w-20" mat-header-cell>
                                Scrip
                            </th>
                            <!-- prod fix -->
                            <!-- <th *matHeaderCellDef class="br" [attr.colspan]="11" mat-header-cell>{{singlePortfolioCategory.categoryName}}</th> -->
                            <th *matHeaderCellDef class="br" [attr.colspan]="11" mat-header-cell>Category name</th>
                            <td *matCellDef="let element" class="br" mat-cell>
                                <div class="bar"><span
                                        *ngIf="element.stockType != 1">{{isLoading?'':element.scripName}}</span>
                                    <span *ngIf="element.stockType == 1">{{isLoading?'':'Portfolio'}}</span></div>
                            </td>
                            <th *matFooterCellDef  class="br proximaFont amt text-right f-600 p-8"
                                mat-header-cell style="background-color: #fff !important;"> Total
                            </th>
                        </ng-container>
                        <ng-container matColumnDef="amt">
                            <th *matHeaderCellDef class="br w-10 text-right" mat-header-cell> Amount invested</th>
                            <th *matHeaderCellDef class="br" mat-header-cell></th>

                            <td *matCellDef="let element" class="br text-right" mat-cell>
                                <div class="bar">{{isLoading?'':'₹'}}<span *ngIf="!isLoading"
                                        appFormatNumber>{{element.amountInvested}}</span></div>
                            </td>
                            <td *matFooterCellDef class="br proximaFont amt text-right f-600 p-8" mat-footer-cell>
                                {{isLoading?'':'₹'}}<span *ngIf="!isLoading"
                                    [value]="singlePortfolio.totalAmountInvested"
                                    appFormatNumber>{{singlePortfolio.totalAmountInvested}}</span></td>
                        </ng-container>
                        <ng-container matColumnDef="cvalue">
                            <th *matHeaderCellDef class="br w-10 text-right" mat-header-cell> Current value</th>
                            <th *matHeaderCellDef class="br" mat-header-cell></th>

                            <td *matCellDef="let element" class="br text-right" mat-cell>
                                <div class="bar">{{isLoading?'':'₹'}}<span *ngIf="!isLoading"
                                        appFormatNumber>{{element.currentMarketValue}}</span></div>
                            </td>
                            <td *matFooterCellDef class="br proximaFont amt text-right f-600 p-8" mat-footer-cell>
                                {{isLoading?'':'₹'}}<span *ngIf="!isLoading" [value]="singlePortfolio.totalCurrentValue"
                                    appFormatNumber>{{singlePortfolio.totalCurrentValue}}</span>
                            </td>
                        </ng-container>
                        <ng-container matColumnDef="gain">
                            <th *matHeaderCellDef class="br w-10 text-right" mat-header-cell> Unrealized gain/loss</th>
                            <th *matHeaderCellDef class="br" mat-header-cell></th>

                            <td *matCellDef="let element" class="br text-right" mat-cell>
                                <div class="bar">{{isLoading?'':'₹'}}<span *ngIf="!isLoading"
                                        appFormatNumber>{{element.unrealizedGainLoss}}</span></div>
                            </td>
                            <td *matFooterCellDef class="br proximaFont amt text-right f-600 p-8" mat-footer-cell>
                                {{isLoading?'':'₹'}}<span *ngIf="!isLoading"
                                    [value]="singlePortfolio.totalUnrealizedGainLoss"
                                    appFormatNumber>{{singlePortfolio.totalUnrealizedGainLoss}}</span>
                            </td>
                        </ng-container>
                        <!-- <ng-container matColumnDef="owner">
                            <th *matHeaderCellDef class="br w-18" mat-header-cell> Owner</th>
                            <th *matHeaderCellDef class="br" mat-header-cell></th>
                            <td mat-cell *matCellDef="let element" class="br">
                                <div class="bar" *ngIf="element.ownerList.length > 0">
                                    <span>{{isLoading?'':element.ownerList[0].name}}</span></div>
                            </td>
                            <th *matFooterCellDef class="br text-right" mat-header-cell></th>

                        </ng-container> -->
                        <ng-container matColumnDef="bal">
                            <th *matHeaderCellDef class="br w-10 text-right" mat-header-cell> Balance shares</th>
                            <th *matHeaderCellDef class="br" mat-header-cell></th>

                            <td *matCellDef="let element" class="br text-right" mat-cell>
                                <div class="bar">
                                    <span *ngIf="element.stockType == 1 && !isLoading">-</span>
                                    <span *ngIf="element.stockType == 3 && !isLoading">{{element.balanceShares}}</span>
                                    <span
                                        *ngIf="element.stockType == 2 && !isLoading">{{element.transactionOrHoldingSummaryList[0].quantity}}</span>
                                </div>
                            </td>
                            <td *matFooterCellDef  class="br t-8 text-right" mat-footer-cell [attr.colspan]="3" ><span style="visibility: hidden;">abc</span></td>

                        </ng-container>
                        <ng-container matColumnDef="price">
                            <th *matHeaderCellDef class="br w-10 text-right" mat-header-cell> Average price</th>
                            <th *matHeaderCellDef class="br" mat-header-cell></th>

                            <td *matCellDef="let element" class="br  text-right" mat-cell>
                                <div class="bar">{{isLoading?'':'₹'}}<span *ngIf="!isLoading"
                                        appFormatNumber>{{element.averagePrice}}</span></div>
                            </td>
                            <!-- <th *matFooterCellDef class="br t-8 text-right" mat-footer-cell><span style="visibility: hidden;">abc</span></th> -->

                        </ng-container>
                        <ng-container matColumnDef="mprice">
                            <th *matHeaderCellDef class="br w-10 text-right" mat-header-cell> Market price</th>
                            <th *matHeaderCellDef class="br" mat-header-cell></th>

                            <td *matCellDef="let element" class="br text-right" mat-cell>
                                <div class="bar">{{isLoading?'':'₹'}}<span *ngIf="!isLoading"
                                        appFormatNumber>{{element.scripCurrentValue}}</span></div>
                            </td>
                            <!-- <th *matFooterCellDef class="br t-8 text-right" mat-footer-cell><span style="visibility: hidden;">abc</span></th> -->

                        </ng-container>

                        <ng-container matColumnDef="ret">
                            <th *matHeaderCellDef class="br w-10 text-right" mat-header-cell> Absolute returns</th>
                            <th *matHeaderCellDef class="br" mat-header-cell></th>

                            <td *matCellDef="let element" class="br text-right" mat-cell>
                                <div class="bar">
                                    <span>{{isLoading?'':element.absoluteReturn}}{{element.absoluteReturn && !isLoading?'%':''}}</span>
                                </div>
                            </td>
                            <td *matFooterCellDef class="br proximaFont amt text-right f-600 p-8" mat-footer-cell>
                                <span>{{isLoading?'':singlePortfolio.totalAbsoluteReturn}}</span>{{singlePortfolio.totalAbsoluteReturn && !isLoading?'%':''}}
                            </td>
                        </ng-container>
                        <!-- <ng-container matColumnDef="xirr">
       <th *matHeaderCellDef class="br text-right" mat-header-cell> XIRR %</th>
       <td *matCellDef="let element" class="br text-right" mat-cell>
         <div class="bar">{{element.xirr}}</div>
       </td>
       <td *matFooterCellDef appFormatNumber class="br text-right" mat-footer-cell>{{ singlePortfolio.xirr}}</td>
     </ng-container> -->
                        <ng-container matColumnDef="dividend">
                            <th *matHeaderCellDef class="br w-10 text-right" mat-header-cell> Dividend</th>
                            <th *matHeaderCellDef class="br" mat-header-cell></th>

                            <td *matCellDef="let element" class="br text-right" mat-cell>
                                <div class="bar">{{isLoading?'':element.dividend}}</div>
                            </td>
                            <td *matFooterCellDef appFormatNumber class="br proximaFont amt text-right f-600 p-8"
                                mat-footer-cell>
                                {{ isLoading?'':singlePortfolio.dividend}}
                            </td>
                        </ng-container>


                        <ng-container matColumnDef="icons">
                            <th *matHeaderCellDef class="" mat-header-cell></th>
                            <th class="br" mat-header-cell></th>
                            <td *matCellDef="let element" class="mat-menu-trigger c-p " [matMenuTriggerFor]="menu25"
                                mat-cell>

                                <img class="c-p " src="/assets/images/svg/dot-menu.svg">
                                <mat-menu #menu25="matMenu">
                                    <button mat-menu-item (click)="editStock(element,singlePortfolio)">Edit</button>
                                    <!-- build issue -->

                                    <button mat-menu-item (click)="opendetailviews(element,singlePortfolio)">Detailed
                                        view</button>

                                    <!-- <button mat-menu-item  (click)="opendetailviews(data)">Detailed view</button> -->

                                    <!-- <button mat-menu-item>Activity</button> -->
                                    <button mat-menu-item (click)="deleteModal('STOCK',element)">Delete</button>
                                </mat-menu>
                            </td>

                            <td *matFooterCellDef class="br t-8 text-right" mat-footer-cell></td>
                        </ng-container>
                        <tr *matHeaderRowDef="displayedColumns25;" mat-header-row></tr>
                        <tr *matRowDef="let row; columns: ['groupHeader']; when: isGroup" mat-row></tr>
                        <tr *matRowDef="let row; columns: displayedColumns25;" mat-row></tr>
                        <tr *matFooterRowDef="footerColumns;" mat-footer-row></tr>

                        <!--        <tr mat-header-row *matHeaderRowDef="['static-header']" class="p-0 bt-0 bb-0"></tr>-->
                    </table>
                </div>



            </div>
        </div>
    </div>
</div>


<div *ngIf="portfolioData.length <= 0 && !isLoading" class="row">
    <div class="d-flex flex-column align-items-center mt-80 col-md-12">
        <img src="assets/images/svg/documents-empty-states.svg">
        <h4 class="text-center mt-12 mb-20">{{noData }}</h4>
        <button mat-stroked-button class="btn-primary addon v-middle" [matMenuTriggerFor]="menu1">ADD NEW
        </button>

        <mat-menu #menu1="matMenu" class="add-new">
            <button (click)="openAddStock('addPortfolio',null)" mat-menu-item class="b-b">
                <div class="row">
                    <div class="col-md-2 pr-8 text-right">
                        <img src="assets/images/svg/dark-three-dot.svg">
                    </div>
                    <div class="col-md-10">
                        <p class="m-0 text-black">Portfolio summary</p>
                        <p class="m-0 f-13 pt-4 text-custom">Add just the overall portfolio
                            <br> summary. Time saver!
                        </p>
                    </div>
                </div>
            </button>
            <button (click)="openAddStock('holding',null)" mat-menu-item class="b-b">
                <div class="row">
                    <div class="col-md-2 pr-8 text-right">
                        <img src="assets/images/svg/dark-download.svg">
                    </div>
                    <div class="col-md-10">
                        <p class="m-0 text-black">Scrip level holdings</p>
                        <p class="m-0 pt-4 f-13 text-custom">Add holding data at
                            <br> scrip level for better reporting
                        </p>
                    </div>
                </div>
            </button>
            <button (click)="openAddStock('transaction',null)" mat-menu-item class="b-b">
                <div class="row">
                    <div class="col-md-2 pr-8 text-right">
                        <img src="assets/images/svg/scheme-icon.svg">
                    </div>
                    <div class="col-md-10">
                        <p class="m-0 text-black">Scrip level transactions</p>
                        <p class="m-0 pt-4 f-13 text-custom">Add transaction data at
                            <br> scrip level for better reporting
                        </p>
                    </div>
                </div>
            </button>
        </mat-menu>
    </div>
</div>

<div id="template" style="display: none;"  *ngIf="portfolioData.length > 0">
    <table cellpadding="0" cellspacing="0" border="0"
        style="width: 900px; font-family: 'Roboto', sans-serif; margin: 0px auto;"
        align="center; page-break-before: always;">

        
        <tr>
            <table  cellpadding="0" cellspacing="0" border="0"
            style="width: 900px; font-family: 'Roboto', sans-serif; margin: 0px auto;"
            align="center; page-break-before: always;">
                <tr>
                    <td style="text-align: left; vertical-align: top;" colspan="3" *ngIf="getOrgData">
                        <div *ngIf="getOrgData.reportLogoUrl">
                            <img width="140px" [src]="getOrgData.reportLogoUrl">
                        </div>
                        <div *ngIf="!getOrgData.reportLogoUrl && getOrgData.logoUrl">
                            <img width="200px" [src]="getOrgData.logoUrl">
                        </div>
                        <div *ngIf="getOrgData.companyName">
                            <span width="200px" style="font-size: 25px;">{{getOrgData.companyName}}</span>
                        </div>
                    </td>
                    <td style="text-align: right;">
                        <p style="margin: 0px; font-weight: 600; font-size: 20px; margin-bottom: 5px;" *ngIf="userInfo">
                            {{(getOrgData.companyName) ? getOrgData.companyName : '-'}}</p>
                        <!-- <p style="margin: 0px; font-size: 14px;" *ngIf="clientData">Himachal Pradesh</p> -->
                        <p style="margin: 0px; font-size: 14px; margin-bottom: 5px;" *ngIf="userInfo"> <strong> Number:</strong>
                            {{(userInfo.mobileList?.length > 0) ? userInfo.mobileList[0].mobileNo : userInfo.mobile}}</p>
                        <p style="margin: 0px; font-size: 14px; margin-bottom: 5px;" *ngIf="userInfo"> <strong> Email:</strong>
                            {{getOrgData.email ? getOrgData.email  : userInfo.email}}</p>
        
                        <p style="margin: 0px; font-size: 14px; margin-bottom: 5px;"> <strong>
                                {{'Stock Summary'}}</strong>
                        </p>
                        <p style="margin: 0px; font-size: 14px; margin-bottom: 5px;"> <strong> Report as on:
                                {{reportDate | date:'dd-MMM-yyyy' }}</strong>
                        </p>
                    </td>
                </tr>
                <tr>
                    <td colspan="4" >
                        <p style="margin-bottom: 10px; font-weight: 700; font-size: 14px; padding-top: 4px;" *ngIf="clientData">
                            Client name: {{(clientData.name) ? clientData.name : '-'}}</p>
                        <p style="margin: 0px; font-weight: 600; font-size: 18px; padding-top: 4px;"
                            *ngIf="clientData">
                            Summary</p>
                    </td>
                </tr>
            </table>
        </tr>
        <tr>
            <td colspan="5" style="padding: 10px;"></td>
        </tr>

        <tr>
            <td>
                <table cellpadding="0" cellspacing="0" border="0" style="width: 100%;">
                    <tr>
                         <td style="border: 1px solid #dee5e7; vertical-align: top; width: 420px;">
                             <div style="background: #F5F7F7; border-top: 1px solid #dee5e7; border-bottom: 1px solid #dee5e7; height: 40px; font-size: 16px; line-height: 40px; padding-left: 8px;">
                                Summary
                            </div>
                            <div style="padding: 22px 10px;">
                                <p style="margin: 0px 0px 5px 0px; font-size: 12px; color: #757575;">Current value</p>
                                <h3 style="margin: 0px; font-size: 20px;">₹<span [value]="grandTotalCurrentValue"
                                appFormatNumber>{{grandTotalCurrentValue}}</span></h3>
                            </div>
                            <table style="width: 100%;   background: #f8f9fa; border-top: 1px solid #dee5e7; padding: 10px;">
                                <tr>
                                    <td style="padding: 8px 0px;">
                                        <p style="font-size: 12px; color: #757575; margin: 0px 0px 0px 0px;">Amount invested </p>
                                        <h5 style="margin: 0px; font-size: 16px;">
                                            ₹<span [value]="grandTotalAmountInvested" appFormatNumber></span>
                                        </h5>
                                    </td>
                                    
                                    <td style="padding: 8px 0px;">
                                        <p style="font-size: 12px; color: #757575; margin: 0px 0px 0px 0px;">  Unrealized gain/loss </p>
                                        <h5 style="margin: 0px; font-size: 16px; color: #5DC644;">
                                            ₹<span [value]="assetStockData.grandTotalUnrealizedGainLoss"
                                                    appFormatNumber>{{assetStockData.grandTotalUnrealizedGainLoss}}</span>
                                        </h5>
                                    </td>

                                    <td style="padding: 8px 0px;">
                                        <p style="font-size: 12px; color: #757575; margin: 0px 0px 0px 0px;">  Returns </p>
                                        <h5 style="margin: 0px; font-size: 16px; color: #5DC644;">
                                            <span>{{assetStockData.grandTotalAbsReturns?assetStockData.grandTotalAbsReturns:0}}{{assetStockData.grandTotalAbsReturns?'%':''}}</span>
                                            <!-- <i class="material-icons v-sub f-18 f-700 textGreen" *ngIf="gain">
                                                arrow_upward
                                            </i>
                                            <i class="material-icons v-sub f-18 f-700 text-danger" *ngIf="!gain">
                                                arrow_downward
                                            </i> -->
                                        </h5>
                                    </td>
                                </tr>
                            </table>

                         </td>

                         <td style="width: 190px; height: 190px; border: 1px solid #dee5e7; border-left: transparent; border-right: transparent;">
                            <div>showPieChart</div>
                         </td>

                         <td style="border: 1px solid #dee5e7; ">
                             <table style="width: 100%;">
                                <tr *ngIf="categories.Banks != undefined">
                                    <td style="padding: 8px; border-bottom: 1px solid #dee5e7;">
                                        <div style="background:#008FFF; margin-right: 10px; width: 10px; display: inline-block; height: 10px;">  </div>
                                        <div style="font-size: 14px; display: inline-block; width: 160px;">Banking</div>
                                        <div style="font-size: 14px; display: inline-block; margin-right: 10px;">{{categories.Banks?'₹':''}}<span [value]="categories.Banks.currentValue"
                                            appFormatNumber>{{categories.Banks.currentValue}}</span></div>
                                        <div style="font-size: 12px; text-align: right; display: inline-block;">{{categories.Banks.perrcentage | number: '1.2-2'}}{{categories.Banks?'%':''}} </div>
                                    </td>
                                </tr>

                                <tr *ngIf="categories.Information_Technology.perrcentage > 0">
                                    <td style="padding: 8px; border-bottom: 1px solid #dee5e7;">
                                        <div style="background:#5DC644; width: 10px; display: inline-block; height: 10px;">  </div>
                                        <div style="font-size: 14px; display: inline-block; width: 150px;">Information technology</div>
                                        <div style="font-size: 14px; display: inline-block;">{{categories.Information_Technology?'₹':''}}<span
                                            [value]="categories.Information_Technology.currentValue"
                                            appFormatNumber>{{categories.Information_Technology.currentValue}}</span></div>
                                        <div style="font-size: 12px; display: inline-block;">{{categories.Information_Technology.perrcentage | number: '1.2-2'}}{{categories.Information_Technology?'%':''}}</div>
                                    </td>
                                </tr>
                                <tr  *ngIf="categories.fmcg.perrcentage > 0">
                                    <td style="padding: 8px; border-bottom: 1px solid #dee5e7;">
                                        <div style="background:#FFC100; width: 10px; display: inline-block; height: 10px;">  </div>
                                        <div style="font-size: 14px; display: inline-block; width: 150px;">FMCG</div>
                                        <div style="font-size: 14px; display: inline-block;">{{categories.fmcg?'₹':''}}<span [value]="categories.fmcg.currentValue"
                                            appFormatNumber>{{categories.fmcg.currentValue}}</span></div>
                                        <div style="font-size: 12px; display: inline-block;">{{categories.fmcg.perrcentage | number: '1.2-2'}}{{categories.fmcg?'%':''}}</div>
                                    </td>
                                </tr>

                                <tr *ngIf="categories.Auto_Ancillaries.perrcentage > 0">
                                    <td style="padding: 10px;">
                                        <div style="background:#FF6823; width: 10px; display: inline-block; height: 10px;">  </div>
                                        <div style="font-size: 14px; display: inline-block; width: 150px;">Auto ancillaries</div>
                                        <div style="font-size: 14px; display: inline-block;">{{categories.Auto_Ancillaries?'₹':''}}<span
                                            [value]="categories.Auto_Ancillaries.currentValue"
                                            appFormatNumber>{{categories.Auto_Ancillaries.currentValue}}</span></div>
                                        <div style="font-size: 12px; display: inline-block;">{{categories.Auto_Ancillaries.perrcentage | number: '1.2-2'}}{{categories.Auto_Ancillaries?'%':''}}</div>
                                    </td>
                                </tr>

                                <tr *ngIf="categories.OTHERS.perrcentage > 0">
                                    <td style="padding: 8px; border-bottom: 1px solid #dee5e7;">
                                        <div style="background:#A0AEB4; width: 10px; display: inline-block; height: 10px;">  </div>
                                        <div style="font-size: 14px; display: inline-block; width: 150px;">Other</div>
                                        <div style="font-size: 14px; display: inline-block;">{{categories.OTHERS?'₹':''}}<span
                                            [value]="categories.OTHERS.currentValue"
                                            appFormatNumber>{{categories.OTHERS.currentValue}}</span></div>
                                        <div style="font-size: 12px; display: inline-block;">{{categories.Auto_Ancillaries.perrcentage | number: '1.2-2'}}{{categories.Auto_Ancillaries?'%':''}}</div>
                                    </td>
                                </tr>     
                            </table>
                         </td>

                    </tr>
                </table>
            </td>
        </tr>
         
        <tr *ngFor="let singlePortfolio of portfolioData">
            <td>
                <p style="margin: 30px 0px 0px 0px; padding: 8px; color: #008FFF; border: 1px solid #dee5e7; border-bottom: transparent; ">{{singlePortfolio.portfolioName}} |
                    {{singlePortfolio.ownerList.length > 0?singlePortfolio.ownerList[0].name:''}}</p>
                <table style="width: 100%; font-size: 14px; border: 1px solid #dee5e7;" cellpadding="0" cellspacing="0"  >
                    <tr>
                        <td style="background: #F5F7F7; padding: 10px; border-right: 1px solid #dee5e7;border-bottom: 1px solid #dee5e7;"> Scrip </td>
                        <td style="background: #F5F7F7;padding: 10px; text-align: right; border-right: 1px solid #dee5e7;border-bottom: 1px solid #dee5e7;">Amount invested </td>
                        <td style="background: #F5F7F7;padding: 10px; text-align: right; border-right: 1px solid #dee5e7;border-bottom: 1px solid #dee5e7;">Current value</td>
                        <td style="background: #F5F7F7;padding: 10px; text-align: right; border-right: 1px solid #dee5e7;border-bottom: 1px solid #dee5e7;">Unrealized gain/loss</td>
                        <td style="background: #F5F7F7;padding: 10px; text-align: right; border-right: 1px solid #dee5e7;border-bottom: 1px solid #dee5e7;">Balance shares</td>
                        <td style="background: #F5F7F7;padding: 10px; text-align: right; border-right: 1px solid #dee5e7;border-bottom: 1px solid #dee5e7;">Average price</td>
                        <td style="background: #F5F7F7; padding: 10px; text-align: right; border-right: 1px solid #dee5e7;border-bottom: 1px solid #dee5e7;">Market price</td>
                        <td style="background: #F5F7F7; padding: 10px; text-align: right; border-right: 1px solid #dee5e7;border-bottom: 1px solid #dee5e7;">Absolute returns</td>
                        <td style="background: #F5F7F7; padding: 10px; text-align: right; border-bottom: 1px solid #dee5e7;">Dividend</td>
                    </tr>

                    <tr *ngFor="let element of singlePortfolio.stockListGroup">
                        <td *ngIf="!element.id" colspan="9" style="color: #008FFF; padding: 10px; text-align: center; border-bottom: 1px solid #dee5e7;">
                           {{element.group}}
                        </td>
                        <td *ngIf="element.id" style="border-bottom: 1px solid #dee5e7; border-right: 1px solid #dee5e7; padding: 10px;"><span
                            *ngIf="element.stockType != 1">{{element.scripName}}</span>
                        <span *ngIf="element.stockType == 1">Portfolio</span></td>
                        <td *ngIf="element.id" style="padding: 10px; text-align: right; border-right: 1px solid #dee5e7; border-bottom: 1px solid #dee5e7;">₹<span
                            appFormatNumber>{{element.amountInvested}}</span></td>
                        <td *ngIf="element.id" style="padding: 10px; text-align: right; border-right: 1px solid #dee5e7; border-bottom: 1px solid #dee5e7;">₹<span
                            appFormatNumber>{{element.currentMarketValue}}</span></td>
                        <td *ngIf="element.id" style="padding: 10px; text-align: right; border-right: 1px solid #dee5e7; border-bottom: 1px solid #dee5e7;">₹<span
                            appFormatNumber>{{element.unrealizedGainLoss}}</span></td>
                        <td *ngIf="element.id" style="padding: 10px; text-align: right; border-right: 1px solid #dee5e7; border-bottom: 1px solid #dee5e7;"><span *ngIf="element.stockType == 1 && !isLoading">-</span>
                            <span *ngIf="element.stockType == 3 && !isLoading">{{element.balanceShares}}</span>
                            <span
                                *ngIf="element.stockType == 2 && !isLoading">{{element.transactionOrHoldingSummaryList[0].quantity}}</span></td>
                        <td *ngIf="element.id" style="padding: 10px; text-align: right; border-right: 1px solid #dee5e7; border-bottom: 1px solid #dee5e7;">{{isLoading?'':'₹'}}<span *ngIf="!isLoading"
                            appFormatNumber>{{element.averagePrice}}</span></td>
                        <td *ngIf="element.id" style="padding: 10px; text-align: right; border-right: 1px solid #dee5e7; border-bottom: 1px solid #dee5e7;">{{isLoading?'':'₹'}}<span *ngIf="!isLoading"
                            appFormatNumber>{{element.scripCurrentValue}}</span></td>
                        <td *ngIf="element.id" style="padding: 10px; text-align: right; border-right: 1px solid #dee5e7; border-bottom: 1px solid #dee5e7;"><span>{{isLoading?'':element.absoluteReturn}}{{element.absoluteReturn && !isLoading?'%':''}}</span></td>
                        <td *ngIf="element.id" style="padding: 10px; text-align: right;   border-bottom: 1px solid #dee5e7;">{{isLoading?'':element.dividend}}</td>
                    </tr>
                    <tr>
                        <td style="  border-right: 1px solid #dee5e7; padding: 10px; text-align: right; font-weight: 600;">Total</td>
                        <td style="padding: 10px; text-align: right; border-right: 1px solid #dee5e7;  font-weight: 600;">{{isLoading?'':'₹'}}<span *ngIf="!isLoading"
                            [value]="singlePortfolio.totalAmountInvested"
                            appFormatNumber>{{singlePortfolio.totalAmountInvested}}</span></td>
                        <td style="padding: 10px; text-align: right; border-right: 1px solid #dee5e7;  font-weight: 600;">{{isLoading?'':'₹'}}<span *ngIf="!isLoading" [value]="singlePortfolio.totalCurrentValue"
                            appFormatNumber>{{singlePortfolio.totalCurrentValue}}</span></td>
                        <td style="padding: 10px; text-align: right; border-right: 1px solid #dee5e7;  font-weight: 600;">{{isLoading?'':'₹'}}<span *ngIf="!isLoading"
                            [value]="singlePortfolio.totalUnrealizedGainLoss"
                            appFormatNumber>{{singlePortfolio.totalUnrealizedGainLoss}}</span></td>
                        <td style="padding: 10px; text-align: right;   ">     </td>
                        <td style="padding: 10px; text-align: right;   ">   </td>
                        <td style="padding: 10px; text-align: right;    border-right: 1px solid #dee5e7; ">    </td>
                        <td style="padding: 10px; text-align: right; border-right: 1px solid #dee5e7;   font-weight: 600;"><span>{{isLoading?'':singlePortfolio.totalAbsoluteReturn}}</span>{{singlePortfolio.totalAbsoluteReturn && !isLoading?'%':''}}</td>
                        <td style="padding: 10px; text-align: right;   ">  </td>
                    </tr>

                </table>

 
                

            </td>
        </tr>

        </table>
</div>