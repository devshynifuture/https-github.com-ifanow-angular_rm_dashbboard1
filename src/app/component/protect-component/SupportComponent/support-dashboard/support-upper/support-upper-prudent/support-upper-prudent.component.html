<div class="dialogclose">
    <div class="row popup-header-fix-100">
        <div class="col-md-2 border-right-1 p-0">
            <img class="imgAdLogo"
                src="https://res.cloudinary.com/futurewise/image/upload/v1566029063/icons_fakfxf.png">
        </div>
        <div class="col-md-8 p-0 d-flex justify-content-center align-items-center ">

            <p class="f-16 mb-0">
                Prudent - Scheme Mapping
            </p>
        </div>
        <div class="col-md-2 text-right">
            <i (click)="supportUpperService.dialogClose()" class="material-icons pt-16 c-p pr-16">
                clear
            </i>
        </div>
    </div>
</div>

<div class="row pt-72">
    <div class="col-md-12">
        <h5> Search Prudent scheme</h5>
    </div>

    <div class="col-md-6">
        <mat-form-field appearance="standard" floatLabel="never">
            <input #inputSearch class="form-control" matInput placeholder="Search" aria-label="State"
                [matAutocomplete]="auto1" [formControl]="searchSchemeControl">
            <mat-autocomplete #auto1="matAutocomplete" [displayWith]="displayFn">
                <mat-option *ngIf="isLoadingForDropDown" class="is-loading">Loading...</mat-option>
                <!-- <ng-container *ngIf="!isLoadingForDropDown">
                <mat-option *ngFor="let scheme of searchSchemes" (click)="mapSchemeCodeAndOther(element, scheme)"
                    [value]="scheme.schemeName" [matTooltip]="scheme.schemeName" matTooltipPosition="after">
                    <span><b>{{scheme.schemeName}}</b> </span>
                </mat-option>
            </ng-container> -->
            </mat-autocomplete>
        </mat-form-field>
    </div>

    <div class="col-md-3 pt-11" *ngIf="!isLoading">
        <mat-select (selectionChange)="setmapUnmap($event)" [formControl]="mapUnmapFC">
            <mat-option *ngFor="let item of prudentSelectOptionList" [value]="item.id">
                {{ item.title }}
            </mat-option>
        </mat-select>
    </div>

    <div class="col-md-3">
        <mat-paginator [length]="totalPrudentCount" [hidePageSize]="true" [pageSize]="5"
            [ngClass]="{'cursor-not-allowed': isLoading}"
            (page)="!isLoading ? pageEvent = onPaginationChange($event): $event.preventDefault()">
        </mat-paginator>
    </div>
</div>
<div class="row pt-16">
    <div class="col-md-12 back-office-table">
        <table id="table-low" mat-table [dataSource]="dataSource" appSkeletonLoading [appSkeletonLoading]="isLoading">
            <!-- Position Column -->
            <ng-container matColumnDef="name">
                <th class="b-a" mat-header-cell *matHeaderCellDef> NJ name </th>
                <td mat-cell class="b-a" *matCellDef="let element">
                    <div class="bar">
                        {{element.name}}
                    </div>
                </td>
            </ng-container>

            <!-- Name Column -->
            <ng-container matColumnDef="nav">
                <th class="b-a" mat-header-cell *matHeaderCellDef> NJ NAV </th>
                <td class="b-a" mat-cell *matCellDef="let element">
                    <div class="bar">
                        {{element.nav}}
                    </div>
                </td>
            </ng-container>

            <!-- Weight Column -->
            <ng-container matColumnDef="schemeName">
                <th class="b-a" mat-header-cell *matHeaderCellDef> Search corresponding scheme name </th>
                <td class="b-a matInputClass" mat-cell *matCellDef="let element">
                    <mat-form-field *ngIf="isMapped == false" appearance="standard" floatLabel="never">
                        <input class="form-control" matInput placeholder="Search"
                            (focus)="showSuggestionsBasedOnSchemeName(element)" aria-label="State"
                            [matAutocomplete]="auto" [formControl]="schemeControl">
                        <mat-autocomplete #auto="matAutocomplete" [displayWith]="displayFn">
                            <mat-option *ngIf="isLoadingForDropDown" class="is-loading">Loading...</mat-option>
                            <ng-container *ngIf="!isLoadingForDropDown">
                                <mat-option *ngFor="let scheme of filteredSchemes"
                                    (click)="mapSchemeCodeAndOther(element, scheme)" [value]="scheme"
                                    [matTooltip]="scheme.schemeName" matTooltipPosition="after">
                                    <span><b>{{scheme.schemeName}}</b> </span>
                                </mat-option>
                            </ng-container>
                        </mat-autocomplete>

                    </mat-form-field>
                    <div class="bar" *ngIf="isMapped == true">
                        {{element.schemeName}}
                    </div>
                    <br>
                    <ng-container *ngIf="filteredSchemeError">
                        <span class="f-12">
                            {{errorMsg}}
                        </span>
                    </ng-container>
                </td>
            </ng-container>

            <!-- Symbol Column -->
            <ng-container matColumnDef="schemeCode">
                <th class="b-a" mat-header-cell *matHeaderCellDef> Scheme code </th>
                <td class="b-a" mat-cell *matCellDef="let element">
                    <div class="bar">
                        {{element.schemeCode}}
                    </div>
                </td>
            </ng-container>

            <ng-container matColumnDef="amficode">
                <th class="b-a" mat-header-cell *matHeaderCellDef> AMFI code </th>
                <td class="b-a" mat-cell *matCellDef="let element">
                    <div class="bar">
                        {{element.amfiCode}}
                    </div>
                </td>
            </ng-container>


            <ng-container matColumnDef="navTwo">
                <th class="b-a" mat-header-cell *matHeaderCellDef> NAV </th>
                <td class="b-a" mat-cell *matCellDef="let element">
                    <div class="bar">
                        {{element.nav}}
                    </div>
                </td>
            </ng-container>

            <ng-container matColumnDef="navDate">
                <th class="b-a" mat-header-cell *matHeaderCellDef> NAV date </th>
                <td class="b-a" mat-cell *matCellDef="let element">
                    <div class="bar">
                        {{element.navDate == ''?'':(element.navDate | date: 'dd/MM/yyyy')}}
                    </div>
                </td>
            </ng-container>

            <ng-container matColumnDef="njCount">
                <th class="b-a" mat-header-cell *matHeaderCellDef> NJ count </th>
                <td class="b-a" mat-cell *matCellDef="let element">
                    <div class="bar">
                        {{element.njPrudentCount}}
                    </div>
                </td>
            </ng-container>

            <ng-container matColumnDef="map">
                <th class="b-a" mat-header-cell *matHeaderCellDef> Map / Unmap </th>
                <td class="b-a" mat-cell *matCellDef="let element">
                    <button *ngIf="isMapped == true" class="btn-primary btn-Map" mat-stroked-button
                        (click)="mapUnmappedPrudentScheme(element)">
                        Unmap
                    </button>
                    <button *ngIf="isMapped == false" class="btn-primary btn-Map" mat-stroked-button
                        [disabled]="!element.isSchemeSelected"
                        [ngClass]="{'cursor-not-allowed': !element.isSchemeSelected}"
                        (click)="element.isSchemeSelected ? (element.isMapped ? unMapMappedPrudentScheme(element):mapUnmappedPrudentScheme(element)):$event.preventDefault()">
                        Map
                    </button>
                </td>
            </ng-container>

            <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
            <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
        </table>
        <div class="row" *ngIf="dataSource.data.length==0">
            <h4 class="col-md-12 text-center p-44 b-a">
                No Data Found
            </h4>
        </div>
    </div>
</div>